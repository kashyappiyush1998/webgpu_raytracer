(()=>{"use strict";var e,t,r,n,s={927:(e,t,r)=>{r.a(e,(async(e,t)=>{try{var n=r(943),s=r(853);const e=document.getElementById("gfx-main"),o=document.getElementById("change-every-frame"),i=document.getElementById("change-every-second"),a=new n.Z(1024);await a.make_scene();const c=new s.A(e,o,i,a);await c.Initialize(),t()}catch(e){t(e)}}),1)},853:(e,t,r)=>{r.d(t,{A:()=>i});const n="@group(0) @binding(0) var screen_sampler : sampler;\r\n@group(0) @binding(1) var color_buffer : texture_2d<f32>;\r\n\r\nstruct VertexOutput {\r\n    @builtin(position) Position : vec4<f32>,\r\n    @location(0) TexCoord : vec2<f32>,\r\n}\r\n\r\n@vertex\r\nfn vert_main(@builtin(vertex_index) VertexIndex : u32) -> VertexOutput {\r\n\r\n    var positions = array<vec2<f32>, 6>(\r\n        vec2<f32>( 1.0,  1.0),\r\n        vec2<f32>( 1.0, -1.0),\r\n        vec2<f32>(-1.0, -1.0),\r\n        vec2<f32>( 1.0,  1.0),\r\n        vec2<f32>(-1.0, -1.0),\r\n        vec2<f32>(-1.0,  1.0)\r\n    );\r\n\r\n    var texCoords = array<vec2<f32>, 6>(\r\n        vec2<f32>(1.0, 0.0),\r\n        vec2<f32>(1.0, 1.0),\r\n        vec2<f32>(0.0, 1.0),\r\n        vec2<f32>(1.0, 0.0),\r\n        vec2<f32>(0.0, 1.0),\r\n        vec2<f32>(0.0, 0.0)\r\n    );\r\n\r\n    var output : VertexOutput;\r\n    output.Position = vec4<f32>(positions[VertexIndex], 0.0, 1.0);\r\n    output.TexCoord = texCoords[VertexIndex];\r\n    return output;\r\n}\r\n\r\n@fragment\r\nfn frag_main(@location(0) TexCoord : vec2<f32>) -> @location(0) vec4<f32> {\r\n  return textureSample(color_buffer, screen_sampler, TexCoord);\r\n}";class s{async initialize(e,t){for(var r=new Array(6),n=0;n<6;n++){const e=await fetch(t[n]),s=await e.blob();r[n]=await createImageBitmap(s)}await this.loadImageBitmaps(e,r),this.view=this.texture.createView({format:"rgba8unorm",dimension:"cube",aspect:"all",baseMipLevel:0,mipLevelCount:1,baseArrayLayer:0,arrayLayerCount:6}),this.sampler=e.createSampler({addressModeU:"repeat",addressModeV:"repeat",magFilter:"linear",minFilter:"nearest",mipmapFilter:"nearest",maxAnisotropy:1})}async loadImageBitmaps(e,t){const r={dimension:"2d",size:{width:t[0].width,height:t[0].height,depthOrArrayLayers:6},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT};this.texture=e.createTexture(r);for(var n=0;n<6;n++)e.queue.copyExternalImageToTexture({source:t[n]},{texture:this.texture,origin:[0,0,n]},[t[n].width,t[n].height])}}class o{async initialize(e,t){var r;const n=await fetch(t),s=await n.blob();r=await createImageBitmap(s),await this.loadImageBitmap(e,r),this.view=this.texture.createView({format:"rgba8unorm",dimension:"2d",aspect:"all",baseMipLevel:0,mipLevelCount:1,baseArrayLayer:0,arrayLayerCount:1}),this.sampler=e.createSampler({addressModeU:"repeat",addressModeV:"repeat",magFilter:"linear",minFilter:"nearest",mipmapFilter:"nearest",maxAnisotropy:1})}async loadImageBitmap(e,t){const r={dimension:"2d",size:{width:t.width,height:t.height,depthOrArrayLayers:1},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT};this.texture=e.createTexture(r),e.queue.copyExternalImageToTexture({source:t},{texture:this.texture,origin:[0,0,0]},[t.width,t.height])}}class i{constructor(e,t,r,n){this.render=()=>{const e=performance.now();this.prepareScene();const t=this.device.createCommandEncoder(),r=t.beginComputePass();r.setPipeline(this.ray_tracing_pipeline),r.setBindGroup(0,this.ray_tracing_bind_group),r.dispatchWorkgroups(Math.floor((this.canvas.width+7)/8),Math.floor((this.canvas.height+7)/8),1),r.end();const n=this.context.getCurrentTexture().createView(),s=t.beginRenderPass({colorAttachments:[{view:n,clearValue:{r:.5,g:0,b:.25,a:1},loadOp:"clear",storeOp:"store"}]});s.setPipeline(this.screen_pipeline),s.setBindGroup(0,this.screen_bind_group),s.draw(6,1,0,0),s.end(),this.device.queue.submit([t.finish()]),this.device.queue.onSubmittedWorkDone().then((()=>{this.change_every_frame.innerHTML="<br />RenderTime: "+(performance.now()-e).toFixed(5)+" ms"})),requestAnimationFrame(this.render),performance.now(),performance.now()-this.passedTime>1e3&&(this.change_every_second.innerHTML="<br />FPS: "+(1e3*this.count/(performance.now()-this.passedTime)).toFixed(1),this.passedTime=performance.now(),this.count=0),this.count+=1},this.canvas=e,this.change_every_frame=t,this.change_every_second=r,this.count=0,this.passedTime=0,this.scene=n}async Initialize(){await this.setupDevice(),await this.makeBindGroupLayouts(),await this.createAssets(),await this.makeBindGroups(),await this.makePipeline(),this.render()}async setupDevice(){var e,t;this.adapter=await(null===(e=navigator.gpu)||void 0===e?void 0:e.requestAdapter()),this.device=await(null===(t=this.adapter)||void 0===t?void 0:t.requestDevice()),this.context=this.canvas.getContext("webgpu"),this.format="bgra8unorm",this.context.configure({device:this.device,format:this.format,alphaMode:"opaque"})}async makeBindGroupLayouts(){this.ray_tracing_bind_group_layout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,storageTexture:{access:"write-only",format:"rgba8unorm",viewDimension:"2d"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"uniform"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage",hasDynamicOffset:!1}},{binding:3,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage",hasDynamicOffset:!1}},{binding:4,visibility:GPUShaderStage.COMPUTE,buffer:{type:"read-only-storage",hasDynamicOffset:!1}},{binding:5,visibility:GPUShaderStage.COMPUTE,texture:{viewDimension:"cube"}},{binding:6,visibility:GPUShaderStage.COMPUTE,sampler:{}},{binding:7,visibility:GPUShaderStage.COMPUTE,texture:{viewDimension:"2d"}},{binding:8,visibility:GPUShaderStage.COMPUTE,sampler:{}}]}),this.screen_bind_group_layout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,sampler:{}},{binding:1,visibility:GPUShaderStage.FRAGMENT,texture:{}}]})}async createAssets(){this.color_buffer=this.device.createTexture({size:{width:this.canvas.width,height:this.canvas.height},format:"rgba8unorm",usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.TEXTURE_BINDING}),this.color_buffer_view=this.color_buffer.createView(),this.sampler=this.device.createSampler({addressModeU:"repeat",addressModeV:"repeat",magFilter:"linear",minFilter:"nearest",mipmapFilter:"nearest",maxAnisotropy:1});const e={size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST};this.sceneParameters=this.device.createBuffer(e);const t={size:96*this.scene.triangles.length,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST};this.triangleBuffer=this.device.createBuffer(t);const r={size:32*this.scene.nodesUsed,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST};this.nodeBuffer=this.device.createBuffer(r);const n={size:4*this.scene.triangleCount,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST};this.triangleIndexBuffer=this.device.createBuffer(n),this.sky_material=new s,await this.sky_material.initialize(this.device,["dist/img/sky_back.png","dist/img/sky_front.png","dist/img/sky_left.png","dist/img/sky_right.png","dist/img/sky_top.png","dist/img/sky_bottom.png"]),this.texture_man_head=new o,await this.texture_man_head.initialize(this.device,"dist/models/man_head.png")}async makePipeline(){const e=this.device.createPipelineLayout({bindGroupLayouts:[this.ray_tracing_bind_group_layout]});this.ray_tracing_pipeline=this.device.createComputePipeline({layout:e,compute:{module:this.device.createShaderModule({code:"struct Sphere {\r\n    center: vec3<f32>,\r\n    color: vec3<f32>,\r\n    radius: f32,\r\n}\r\n\r\nstruct Triangle {\r\n    corner_a: vec3<f32>,\r\n    corner_b: vec3<f32>,\r\n    corner_c: vec3<f32>,\r\n    color: vec3<f32>,\r\n    corner_a_uv: vec2<f32>,\r\n    corner_b_uv: vec2<f32>,\r\n    corner_c_uv: vec2<f32>,\r\n}\r\n\r\nstruct ObjectData {\r\n    triangles: array<Triangle>,\r\n}\r\n\r\nstruct Node {\r\n    minCorner: vec3<f32>,\r\n    leftChild: f32,\r\n    maxCorner: vec3<f32>,\r\n    primitiveCount: f32,\r\n}\r\n\r\nstruct BVH {\r\n    nodes: array<Node>,\r\n}\r\n\r\nstruct ObjectIndices {\r\n    primitiveIndices: array<f32>,\r\n}\r\n\r\nstruct Ray {\r\n    direction: vec3<f32>,\r\n    origin: vec3<f32>,\r\n}\r\n\r\nstruct SceneData {\r\n    cameraPos : vec3<f32>,\r\n    cameraForwards : vec3<f32>,\r\n    cameraRight : vec3<f32>,\r\n    maxBounces: f32,\r\n    cameraUp : vec3<f32>,\r\n    sphereCount : f32,\r\n}\r\n\r\nstruct RenderState {\r\n    t: f32,\r\n    color: vec3<f32>,\r\n    hit: bool,\r\n    position: vec3<f32>,\r\n    normal: vec3<f32>,\r\n}\r\n\r\n@group(0) @binding(0) var color_buffer: texture_storage_2d<rgba8unorm, write>;\r\n@group(0) @binding(1) var<uniform> scene: SceneData;\r\n@group(0) @binding(2) var<storage, read> objects: ObjectData;\r\n@group(0) @binding(3) var<storage, read> tree: BVH;\r\n@group(0) @binding(4) var<storage, read> triangleLookup: ObjectIndices;\r\n@group(0) @binding(5) var skyMaterial: texture_cube<f32>;\r\n@group(0) @binding(6) var skySampler: sampler;\r\n@group(0) @binding(7) var texture: texture_2d<f32>; \r\n@group(0) @binding(8) var textureSampler: sampler;\r\n\r\n@compute @workgroup_size(8,8,1)\r\nfn main(@builtin(global_invocation_id) GlobalInvocationID : vec3<u32>) {\r\n\r\n    let screen_size: vec2<i32> = vec2<i32>(textureDimensions(color_buffer));\r\n    let screen_pos : vec2<i32> = vec2<i32>(i32(GlobalInvocationID.x), i32(GlobalInvocationID.y));\r\n\r\n    if (screen_pos.x >= screen_size.x || screen_pos.y >= screen_size.y) {\r\n        return;\r\n    }\r\n\r\n    let horizontal_coefficient: f32 = (f32(screen_pos.x) - f32(screen_size.x) / 2) / f32(screen_size.x);\r\n    let vertical_coefficient: f32 = (f32(screen_pos.y) - f32(screen_size.y) / 2) / f32(screen_size.x);\r\n    let forwards: vec3<f32> = scene.cameraForwards;\r\n    let right: vec3<f32> = scene.cameraRight;\r\n    let up: vec3<f32> = scene.cameraUp;\r\n\r\n    var myRay: Ray;\r\n    myRay.direction = normalize(forwards + horizontal_coefficient * right + vertical_coefficient * up);\r\n    myRay.origin = scene.cameraPos;\r\n\r\n    var pixel_color : vec3<f32> = rayColor(myRay);\r\n\r\n    textureStore(color_buffer, screen_pos, vec4<f32>(pixel_color, 1.0));\r\n}\r\n\r\nfn rayColor(ray: Ray) -> vec3<f32> {\r\n\r\n    var color: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);\r\n    var result: RenderState;\r\n\r\n    var temp_ray: Ray;\r\n    temp_ray.origin = ray.origin;\r\n    temp_ray.direction = ray.direction;\r\n\r\n    let bounces: u32 = 1;//u32(scene.maxBounces);\r\n\r\n    for(var bounce: u32 = 0; bounce < bounces; bounce++) {\r\n        result = trace(temp_ray);\r\n        color += result.color;\r\n\r\n        if(!result.hit){\r\n            break;\r\n        }\r\n\r\n        temp_ray.origin = result.position;\r\n        temp_ray.direction = normalize(reflect(temp_ray.direction, result.normal));\r\n    }\r\n\r\n    color /= f32(bounces);\r\n\r\n    // if(result.hit) {\r\n    //     color = vec3<f32>(1.0, 1.0, 1.0);\r\n    // }\r\n\r\n    return color;\r\n}\r\n\r\nfn trace(ray: Ray) -> RenderState {\r\n\r\n    var renderState: RenderState;\r\n    renderState.hit = false;\r\n    var nearestHit: f32 = 9999;\r\n\r\n\r\n    var node: Node = tree.nodes[0];\r\n    var stack: array<Node, 15>;\r\n    var stackLocation: u32 = 0;\r\n\r\n    while(true) {\r\n\r\n        var primitiveCount: u32 = u32(node.primitiveCount);\r\n        var contents: u32 = u32(node.leftChild);\r\n\r\n        if(primitiveCount == 0){\r\n\r\n            var child1: Node = tree.nodes[contents];\r\n            var child2: Node = tree.nodes[contents + 1];\r\n\r\n            var distance1: f32 = hit_aabb(ray, child1);\r\n            var distance2: f32 = hit_aabb(ray, child2);\r\n\r\n            if(distance1 > distance2) {\r\n                var tempDist: f32 = distance1;\r\n                distance1 = distance2;\r\n                distance2 = tempDist;\r\n\r\n                var tempChild: Node = child1;\r\n                child1 = child2;\r\n                child2 = tempChild;\r\n            }\r\n\r\n            if(distance1 > nearestHit){\r\n                if(stackLocation == 0) {\r\n                    break;\r\n                }\r\n                else {\r\n                    stackLocation -= 1;\r\n                    node = stack[stackLocation];\r\n                }\r\n            }\r\n            else {\r\n                node = child1;\r\n                if(distance2 < nearestHit) {\r\n                    stack[stackLocation] = child2;\r\n                    stackLocation += 1;\r\n                }\r\n            }\r\n        }\r\n        else{\r\n\r\n            for(var i: u32 = 0; i < primitiveCount; i++) {\r\n                var newRenderState: RenderState;\r\n                var barycentric_coordinates : vec3<f32> = hit_triangle(ray, objects.triangles[u32(triangleLookup.primitiveIndices[i + contents])], 0.001, nearestHit, renderState, &newRenderState);\r\n\r\n                var u: f32 = barycentric_coordinates[0];\r\n                var v: f32 = barycentric_coordinates[1];\r\n                var w: f32 = barycentric_coordinates[2];\r\n\r\n                if(newRenderState.hit){\r\n                    var uv_coords: vec2<f32> = uv_triangle(objects.triangles[u32(triangleLookup.primitiveIndices[i + contents])], u, v, w);\r\n                    var color: vec4<f32> = textureSampleLevel(texture, textureSampler, uv_coords, 0.0);\r\n                    nearestHit = newRenderState.t;\r\n                    renderState = newRenderState;\r\n                    // renderState.color = vec3<f32>(uv_coords.x, uv_coords.y, 0.0);\r\n                    renderState.color = color.xyz;\r\n                }\r\n            }\r\n            if(stackLocation ==0 ) {\r\n                break;\r\n            }\r\n            else {\r\n                stackLocation -= 1;\r\n                node = stack[stackLocation];\r\n            }\r\n        }\r\n    }\r\n\r\n    if(!renderState.hit) {\r\n        // For white sky\r\n        // renderState.color = vec3<f32>(1.0, 1.0, 1.0);\r\n        renderState.color = textureSampleLevel(skyMaterial, skySampler, ray.direction, 0.0).xyz;   \r\n    }\r\n\r\n    return renderState;\r\n}\r\n\r\n// fn hit_sphere(ray: Ray, sphere: Sphere, tMin: f32, tMax: f32, oldRenderState: RenderState) -> RenderState {\r\n//     let co: vec3<f32> = ray.origin - sphere.center;\r\n//     let a: f32 = dot(ray.direction, ray.direction);\r\n//     let b: f32 = 2.0 * dot(ray.direction, co);\r\n//     let c: f32 = dot(co, co) - sphere.radius * sphere.radius;\r\n//     let discriminant: f32 = b * b - 4.0 * a * c;\r\n\r\n//     renderState.color = oldRenderState.color;\r\n\r\n//     if(discriminant > 0.0) {\r\n\r\n//         let t: f32 = (-b - sqrt(discriminant)) / (2 * a);\r\n\r\n//         if(t > tMin && t < tMax) {\r\n//             renderState.t = t;\r\n//             renderState.position = ray.origin + t * ray.direction;\r\n//             renderState.normal = normalize(renderState.position - sphere.center);\r\n//             renderState.color = sphere.color;\r\n//             renderState.hit = true;\r\n//             return renderState;\r\n//         }\r\n//     }\r\n\r\n//     renderState.hit = false;\r\n//     return renderState;\r\n// }\r\n\r\nfn uv_triangle(tri: Triangle, u: f32, v: f32, w: f32) -> vec2<f32> {\r\n    var uv_coord: vec2<f32>;\r\n    uv_coord = u * tri.corner_a_uv + v * tri.corner_b_uv + w * tri.corner_c_uv; \r\n    return uv_coord;\r\n}\r\n\r\nfn hit_triangle(ray: Ray, tri: Triangle, tMin: f32, tMax: f32, oldRenderState: RenderState, newRenderState: ptr<function, RenderState>) -> vec3<f32> {\r\n    \r\n    //Set up a blank renderstate,\r\n    //right now this hasn't hit anything\r\n    newRenderState.color = oldRenderState.color;\r\n    newRenderState.hit = false;\r\n\r\n    //Direction vectors\r\n    let edge_ab: vec3<f32> = tri.corner_b - tri.corner_a;\r\n    let edge_ac: vec3<f32> = tri.corner_c - tri.corner_a;\r\n    //Normal of the triangle\r\n    var n: vec3<f32> = normalize(cross(edge_ab, edge_ac));\r\n    var ray_dot_tri: f32 = dot(ray.direction, n);\r\n    //backface reversal\r\n    if (ray_dot_tri > 0.0) {\r\n        ray_dot_tri = ray_dot_tri * -1;\r\n        n = n * -1;\r\n    }\r\n    //early exit, ray parallel with triangle surface\r\n    if (abs(ray_dot_tri) < 0.00001) {\r\n        return vec3<f32>(0, 0, 0);\r\n    }\r\n\r\n    var system_matrix: mat3x3<f32> = mat3x3<f32>(\r\n        ray.direction,\r\n        tri.corner_a - tri.corner_b,\r\n        tri.corner_a - tri.corner_c\r\n    );\r\n    let denominator: f32 = determinant(system_matrix);\r\n    if (abs(denominator) < 0.00001) {\r\n        return vec3<f32>(0, 0, 0);\r\n    }\r\n\r\n    system_matrix = mat3x3<f32>(\r\n        ray.direction,\r\n        tri.corner_a - ray.origin,\r\n        tri.corner_a - tri.corner_c\r\n    );\r\n    let u: f32 = determinant(system_matrix) / denominator;\r\n    \r\n    if (u < 0 || u > 1) {\r\n        return vec3<f32>(0, 0, 0);\r\n    }\r\n\r\n    system_matrix = mat3x3<f32>(\r\n        ray.direction,\r\n        tri.corner_a - tri.corner_b,\r\n        tri.corner_a - ray.origin,\r\n    );\r\n    let v: f32 = determinant(system_matrix) / denominator;\r\n    if (v < 0.0 || u + v > 1.0) {\r\n        return vec3<f32>(0, 0, 0);\r\n    }\r\n\r\n    system_matrix = mat3x3<f32>(\r\n        tri.corner_a - ray.origin,\r\n        tri.corner_a - tri.corner_b,\r\n        tri.corner_a - tri.corner_c\r\n    );\r\n    let t: f32 = determinant(system_matrix) / denominator;\r\n\r\n    if (t > tMin && t < tMax) {\r\n\r\n        newRenderState.position = ray.origin + t * ray.direction;\r\n        newRenderState.normal = n;\r\n        newRenderState.color = tri.color;\r\n        newRenderState.t = t;\r\n        newRenderState.hit = true;\r\n        return vec3<f32>(u, v, 1-u-v);\r\n    }\r\n\r\n    return vec3<f32>(u, v, 1-u-v);\r\n}\r\n\r\nfn hit_aabb(ray: Ray, node: Node) -> f32 {\r\n    var inverseDir: vec3<f32> = vec3<f32>(1.0) / ray.direction;\r\n    var t1: vec3<f32> = (node.minCorner - ray.origin) * inverseDir;\r\n    var t2: vec3<f32> = (node.maxCorner - ray.origin) * inverseDir;\r\n    var tMin: vec3<f32> = min(t1, t2);\r\n    var tMax: vec3<f32> = max(t1, t2);\r\n\r\n    var t_min: f32 = max(max(tMin.x, tMin.y), tMin.z);\r\n    var t_max: f32 = min(min(tMax.x, tMax.y), tMax.z);\r\n\r\n    if (t_min > t_max || t_max < 0) {\r\n        return 99999;\r\n    }\r\n    else {\r\n        return t_min;\r\n    }\r\n}"}),entryPoint:"main"}});const t=this.device.createPipelineLayout({bindGroupLayouts:[this.screen_bind_group_layout]});this.screen_pipeline=this.device.createRenderPipeline({layout:t,vertex:{module:this.device.createShaderModule({code:n}),entryPoint:"vert_main"},fragment:{module:this.device.createShaderModule({code:n}),entryPoint:"frag_main",targets:[{format:"bgra8unorm"}]},primitive:{topology:"triangle-list"}})}async makeBindGroups(){this.ray_tracing_bind_group=this.device.createBindGroup({layout:this.ray_tracing_bind_group_layout,entries:[{binding:0,resource:this.color_buffer_view},{binding:1,resource:{buffer:this.sceneParameters}},{binding:2,resource:{buffer:this.triangleBuffer}},{binding:3,resource:{buffer:this.nodeBuffer}},{binding:4,resource:{buffer:this.triangleIndexBuffer}},{binding:5,resource:this.sky_material.view},{binding:6,resource:this.sky_material.sampler},{binding:7,resource:this.texture_man_head.view},{binding:8,resource:this.texture_man_head.sampler}]}),this.screen_bind_group=this.device.createBindGroup({layout:this.screen_bind_group_layout,entries:[{binding:0,resource:this.sampler},{binding:1,resource:this.color_buffer_view}]})}prepareScene(){const e={cameraPos:this.scene.camera.position,cameraForward:this.scene.camera.forwards,cameraRight:this.scene.camera.right,cameraUp:this.scene.camera.up,triangleCount:this.scene.triangles.length};this.device.queue.writeBuffer(this.sceneParameters,0,new Float32Array([e.cameraPos[0],e.cameraPos[1],e.cameraPos[2],1,e.cameraForward[0],e.cameraForward[1],e.cameraForward[2],1,e.cameraRight[0],e.cameraRight[1],e.cameraRight[2],4,e.cameraUp[0],e.cameraUp[1],e.cameraUp[2],e.triangleCount]),0,16);const t=new Float32Array(24*this.scene.triangleCount);for(let e=0;e<this.scene.triangleCount;e++){for(var r=0;r<3;r++){for(var n=0;n<3;n++)t[24*e+4*r+n]=this.scene.triangles[e].corners[r][n];t[24*e+4*r+3]=0}for(var s=0;s<3;s++)t[24*e+12+s]=this.scene.triangles[e].color[s];t[24*e+15]=0,t[24*e+16]=this.scene.triangles[e].uv[0][0],t[24*e+17]=this.scene.triangles[e].uv[0][1],t[24*e+18]=this.scene.triangles[e].uv[1][0],t[24*e+19]=this.scene.triangles[e].uv[1][1],t[24*e+20]=this.scene.triangles[e].uv[2][0],t[24*e+21]=this.scene.triangles[e].uv[2][1],t[24*e+22]=0,t[24*e+23]=0}this.device.queue.writeBuffer(this.triangleBuffer,0,t,0,24*this.scene.triangleCount);const o=new Float32Array(8*this.scene.nodesUsed);for(let e=0;e<this.scene.nodesUsed;e++)o[8*e+0]=this.scene.nodes[e].minCorner[0],o[8*e+1]=this.scene.nodes[e].minCorner[1],o[8*e+2]=this.scene.nodes[e].minCorner[2],o[8*e+3]=this.scene.nodes[e].leftChild,o[8*e+4]=this.scene.nodes[e].maxCorner[0],o[8*e+5]=this.scene.nodes[e].maxCorner[1],o[8*e+6]=this.scene.nodes[e].maxCorner[2],o[8*e+7]=this.scene.nodes[e].primitiveCount;this.device.queue.writeBuffer(this.nodeBuffer,0,o,0,8*this.scene.nodesUsed);const i=new Float32Array(this.scene.triangleCount);for(let e=0;e<this.scene.triangleCount;e++)i[e]=this.scene.triangleIndices[e];this.device.queue.writeBuffer(this.triangleIndexBuffer,0,i,0,this.scene.triangleCount)}}},943:(e,t,r)=>{r.d(t,{Z:()=>no});var n={};r.r(n),r.d(n,{createExtMeshFeatures:()=>Tr,decode:()=>wr,encode:()=>vr,name:()=>Mr});var s={};r.r(s),r.d(s,{createExtStructuralMetadata:()=>Qr,decode:()=>Or,encode:()=>Ur,name:()=>Jr});var o={};r.r(o),r.d(o,{decode:()=>sn,name:()=>nn});var i={};r.r(i),r.d(i,{name:()=>fn,preprocess:()=>An});var a={};r.r(a),r.d(a,{name:()=>hn,preprocess:()=>dn});var c={};r.r(c),r.d(c,{decode:()=>On,encode:()=>Un,name:()=>_n,preprocess:()=>Jn});var u={};r.r(u),r.d(u,{decode:()=>As,name:()=>as});var f={};r.r(f),r.d(f,{decode:()=>gs,encode:()=>Cs,name:()=>ms});var A={};r.r(A),r.d(A,{decode:()=>ps,encode:()=>Es,name:()=>ys});var l={};r.r(l),r.d(l,{decode:()=>Gs,encode:()=>Ms,name:()=>Is});var h={};r.r(h),r.d(h,{decode:()=>Ts,name:()=>Ds});var d,B="undefined"!=typeof Float32Array?Float32Array:Array;function m(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function g(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function C(e,t,r){var n=t[0],s=t[1],o=t[2],i=r[0],a=r[1],c=r[2];return e[0]=s*c-o*a,e[1]=o*i-n*c,e[2]=n*a-s*i,e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)}),d=new B(3),B!=Float32Array&&(d[0]=0,d[1]=0,d[2]=0);class b{constructor(e){this.position=new Float32Array(e),this.theta=0,this.phi=0,this.recalculate_vectors()}recalculate_vectors(){this.forwards=new Float32Array([Math.cos(180*this.theta/Math.PI)*Math.cos(180*this.phi/Math.PI),Math.sin(180*this.theta/Math.PI)*Math.cos(180*this.phi/Math.PI),Math.sin(180*this.phi/Math.PI)]),this.right=new Float32Array([0,0,0]),C(this.right,this.forwards,[0,0,1]),this.up=new Float32Array([0,0,0]),C(this.up,this.right,this.forwards)}}class y{}class p{constructor(){this.corners=[],this.uv=[]}build_from_center_and_offsets(e,t,r){this.centroid=[0,0,0];const n=[.33333,.33333,.33333];t.forEach((t=>{var r=[e[0],e[1],e[2]];this.corners.push([r[0]+t[0],r[1]+t[1],r[2]+t[2]]);var s=[r[0],r[1],r[2]];(function(e,t,r){e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2]})(s,s,n),function(e,t,r){e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2]}(this.centroid,this.centroid,s)})),this.color=r}make_centroid(){this.centroid=[(this.corners[0][0]+this.corners[1][0]+this.corners[2][0])/3,(this.corners[0][1]+this.corners[1][1]+this.corners[2][1])/3,(this.corners[0][2]+this.corners[1][2]+this.corners[2][2])/3]}}const E=e=>"function"==typeof e,F=e=>null!==e&&"object"==typeof e,I=e=>F(e)&&e.constructor==={}.constructor,G=e=>"undefined"!=typeof Response&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,M=e=>"undefined"!=typeof Blob&&e instanceof Blob,w=e=>(e=>"undefined"!=typeof ReadableStream&&e instanceof ReadableStream||F(e)&&E(e.tee)&&E(e.cancel)&&E(e.getReader))(e)||(e=>F(e)&&E(e.read)&&E(e.pipe)&&(e=>"boolean"==typeof e)(e.readable))(e);function v(e,t){if(!e)throw new Error(t||"loader assertion failed.")}function D(e){return!!e&&(Array.isArray(e)&&(e=e[0]),Array.isArray(e?.extensions))}function T(e){let t;return v(e,"null loader"),v(D(e),"invalid loader"),Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const R={};class _ extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}const J=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,O=/^([-\w.]+\/[-\w.+]+)/;function U(e,t){return e.toLowerCase()===t.toLowerCase()}function x(e){const t=J.exec(e);return t?t[1]:""}const H=/\?.*/;function L(e){return e.replace(H,"")}function S(e){return G(e)?e.url:M(e)?e.name||"":"string"==typeof e?e:""}function j(e){if(G(e)){const t=e,r=t.headers.get("content-type")||"",n=L(t.url);return function(e){const t=O.exec(e);return t?t[1]:e}(r)||x(n)}return M(e)?e.type||"":"string"==typeof e?x(e):""}async function P(e){if(G(e))return e;const t={},r=function(e){return G(e)?e.headers["content-length"]||-1:M(e)?e.size:"string"==typeof e?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}(e);r>=0&&(t["content-length"]=String(r));const n=S(e),s=j(e);s&&(t["content-type"]=s);const o=await async function(e){if("string"==typeof e)return`data:,${e.slice(0,5)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise((e=>{const r=new FileReader;r.onload=t=>e(t?.target?.result),r.readAsDataURL(t)}))}return e instanceof ArrayBuffer?`data:base64,${function(e){let t="";const r=new Uint8Array(e);for(let e=0;e<r.byteLength;e++)t+=String.fromCharCode(r[e]);return btoa(t)}(e.slice(0,5))}`:null}(e);o&&(t["x-first-bytes"]=o),"string"==typeof e&&(e=(new TextEncoder).encode(e));const i=new Response(e,{headers:t});return Object.defineProperty(i,"url",{value:n}),i}async function N(e,t){if("string"==typeof e){const r=function(e){for(const t in R)if(e.startsWith(t)){const r=R[t];e=e.replace(t,r)}return e.startsWith("http://")||e.startsWith("https://")||(e=`${e}`),e}(e);return function(e){return!function(e){return e.startsWith("http:")||e.startsWith("https:")}(e)&&!function(e){return e.startsWith("data:")}(e)}(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,t):await fetch(r,t)}return await P(e)}function K(){return!("object"==typeof process&&"[object process]"===String(process)&&!process?.browser)||function(){if("undefined"!=typeof window&&"renderer"===window.process?.type)return!0;if("undefined"!=typeof process&&Boolean(process.versions?.electron))return!0;const e="undefined"!=typeof navigator&&navigator.userAgent;return Boolean(e&&e.indexOf("Electron")>=0)}()}const k="4.0.7";class Q{constructor(e,t,r="sessionStorage"){this.storage=function(e){try{const t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch(e){return null}}(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const e=JSON.stringify(this.config);this.storage.setItem(this.id,e)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}var X;function Y(e){return"string"!=typeof e?e:(e=e.toUpperCase(),X[e]||X.WHITE)}function W(e,t){if(!e)throw new Error(t||"Assertion failed")}!function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(X||(X={}));const V=globalThis,Z=(globalThis.document,globalThis.process||{});function q(){let e;if(K()&&V.performance)e=V?.performance?.now?.();else if("hrtime"in Z){const t=Z?.hrtime?.();e=1e3*t[0]+t[1]/1e6}else e=Date.now();return e}globalThis.console,globalThis.navigator;const $={debug:K()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},z={enabled:!0,level:0};function ee(){}const te={},re={once:!0};class ne{constructor({id:e}={id:""}){this.VERSION=k,this._startTs=q(),this._deltaTs=q(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new Q(`__probe-${this.id}__`,z),this.timeStamp(`${this.id} started`),function(e,t=["constructor"]){const r=Object.getPrototypeOf(e),n=Object.getOwnPropertyNames(r),s=e;for(const r of n){const n=s[r];"function"==typeof n&&(t.find((e=>r===e))||(s[r]=n.bind(e)))}}(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((q()-this._startTs).toPrecision(10))}getDelta(){return Number((q()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,$.warn,arguments,re)}error(e){return this._getLogFunction(0,e,$.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,$.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,$.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,$.debug||$.info,arguments,re)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||ee,r&&[r],{tag:ie(t)}):ee}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||ee)}group(e,t,r={collapsed:!1}){const n=oe({logLevel:e,message:t,opts:r}),{collapsed:s}=r;return n.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(e,t,r={}){return this.group(e,t,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||ee)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=se(e)}_getLogFunction(e,t,r,n,s){if(this._shouldLog(e)){s=oe({logLevel:e,message:t,args:n,opts:s}),W(r=r||s.method),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=q();const o=s.tag||s.message;if(s.once&&o){if(te[o])return ee;te[o]=q()}return t=function(e,t,r){if("string"==typeof t){const i=r.time?function(e,t=8){const r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}(function(e){let t;return t=e<10?`${e.toFixed(2)}ms`:e<100?`${e.toFixed(1)}ms`:e<1e3?`${e.toFixed(0)}ms`:`${(e/1e3).toFixed(2)}s`,t}(r.total)):"";n=t=r.time?`${e}: ${i}  ${t}`:`${e}: ${t}`,s=r.color,o=r.background,K||"string"!=typeof n||(s&&(n=`[${Y(s)}m${n}[39m`),o&&(n=`[${Y(o)+10}m${n}[49m`)),t=n}var n,s,o;return t}(this.id,s.message,s),r.bind(console,t,...s.args)}return ee}}function se(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return W(Number.isFinite(t)&&t>=0),t}function oe(e){const{logLevel:t,message:r}=e;e.logLevel=se(t);const n=e.args?Array.from(e.args):[];for(;n.length&&n.shift()!==r;);switch(typeof t){case"string":case"function":void 0!==r&&n.unshift(r),e.message=t;break;case"object":Object.assign(e,t)}"function"==typeof e.message&&(e.message=e.message());const s=typeof e.message;return W("string"===s||"object"===s),Object.assign(e,{args:n},e.opts)}function ie(e){for(const t in e)for(const r in e[t])return r||"untitled";return"empty"}ne.VERSION=k;const ae=new ne({id:"loaders.gl"});class ce{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const ue=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),fe="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),Ae=(fe&&parseFloat(fe[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}},useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ue,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),le={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function he(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function de(){const e=he();return e.globalOptions=e.globalOptions||{...Ae},e.globalOptions}function Be(e,t,r,n){return r=r||[],function(e,t){me(e,null,Ae,le,t);for(const r of t){const n=e&&e[r.id]||{},s=r.options&&r.options[r.id]||{},o=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};me(n,r.id,s,o,t)}}(e,r=Array.isArray(r)?r:[r]),function(e,t,r){const n={...e.options||{}};return function(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}(n,r),null===n.log&&(n.log=new ce),Ce(n,de()),Ce(n,t),n}(t,e,n)}function me(e,t,r,n,s){const o=t||"Top level",i=t?`${t}.`:"";for(const a in e){const c=!t&&F(e[a]);if(!(a in r)&&("baseUri"!==a||t)&&("workerUrl"!==a||!t))if(a in n)ae.warn(`${o} loader option '${i}${a}' no longer supported, use '${n[a]}'`)();else if(!c){const e=ge(a,s);ae.warn(`${o} loader option '${i}${a}' not recognized. ${e}`)()}}}function ge(e,t){const r=e.toLowerCase();let n="";for(const s of t)for(const t in s.options){if(e===t)return`Did you mean '${s.id}.${t}'?`;const o=t.toLowerCase();(r.startsWith(o)||o.startsWith(r))&&(n=n||`Did you mean '${s.id}.${t}'?`)}return n}function Ce(e,t){for(const r in t)if(r in t){const n=t[r];I(n)&&I(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function be(e,t){const r=de(),n=e||r;return"function"==typeof n.fetch?n.fetch:F(n.fetch)?e=>N(e,n.fetch):t?.fetch?t?.fetch:N}function ye(e,t){return pe(e||{},t)}function pe(e,t,r=0){if(r>3)return t;const n={...e};for(const[e,s]of Object.entries(t))s&&"object"==typeof s&&!Array.isArray(s)?n[e]=pe(n[e]||{},t[e],r+1):n[e]=t[e];return n}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,"undefined"!=typeof global&&global,"undefined"!=typeof document&&document;const Ee="object"!=typeof process||"[object process]"!==String(process)||process.browser,Fe="function"==typeof importScripts,Ie="undefined"!=typeof window&&void 0!==window.orientation,Ge="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);Ge&&parseFloat(Ge[1]);class Me{terminate(){}}function we(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const ve=new Map;function De(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function Te(e,t=!0,r){const n=r||new Set;if(e)if(Re(e))n.add(e);else if(Re(e.buffer))n.add(e.buffer);else if(ArrayBuffer.isView(e));else if(t&&"object"==typeof e)for(const r in e)Te(e[r],t,n);return void 0===r?Array.from(n):[]}function Re(e){return!!e&&(e instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&e instanceof MessagePort||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas)}const _e=()=>{};class Je{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return"undefined"!=typeof Worker&&Ee||void 0!==Me&&!Ee}constructor(e){const{name:t,source:r,url:n}=e;we(r||n),this.name=t,this.source=r,this.url=n,this.onMessage=_e,this.onError=e=>console.log(e),this.worker=Ee?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=_e,this.onError=_e,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,t){t=t||Te(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=function(e){we(e.source&&!e.url||!e.source&&e.url);let t=ve.get(e.source||e.url);return t||(e.url&&(t=(r=e.url).startsWith("http")?De(`try {\n  importScripts('${r}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`):r,ve.set(e.url,t)),e.source&&(t=De(e.source),ve.set(e.source,t))),we(t),t;var r}({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=e=>{e.data?this.onMessage(e.data):this.onError(new Error("No data received"))},e.onerror=e=>{this.onError(this._getErrorFromErrorEvent(e)),this.terminated=!0},e.onmessageerror=e=>console.error(e),e}_createNodeWorker(){let e;if(this.url){const t=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new Me(t,{eval:!1})}else{if(!this.source)throw new Error("no worker");e=new Me(this.source,{eval:!0})}return e.on("message",(e=>{this.onMessage(e)})),e.on("error",(e=>{this.onError(e)})),e.on("exit",(e=>{})),e}}class Oe{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,t){this.name=e,this.workerThread=t,this.result=new Promise(((e,t)=>{this._resolve=e,this._reject=t}))}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){we(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){we(this.isRunning),this.isRunning=!1,this._reject(e)}}class Ue{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return Je.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach((e=>e.destroy())),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},void 0!==e.name&&(this.name=e.name),void 0!==e.maxConcurrency&&(this.maxConcurrency=e.maxConcurrency),void 0!==e.maxMobileConcurrency&&(this.maxMobileConcurrency=e.maxMobileConcurrency),void 0!==e.reuseWorkers&&(this.reuseWorkers=e.reuseWorkers),void 0!==e.onDebug&&(this.onDebug=e.onDebug)}async startJob(e,t=(e,t,r)=>e.done(r),r=(e,t)=>e.error(t)){const n=new Promise((n=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:n}),this)));return this._startQueuedJob(),await n}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new Oe(t.name,e);e.onMessage=e=>t.onMessage(r,e.type,e.payload),e.onError=e=>t.onError(r,e),t.onStart(r);try{await r.result}catch(e){console.error(`Worker exception: ${e}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Ee||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Je({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Ie?this.maxMobileConcurrency:this.maxConcurrency}}const xe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class He{props;workerPools=new Map;static _workerFarm;static isSupported(){return Je.isSupported()}static getWorkerFarm(e={}){return He._workerFarm=He._workerFarm||new He({}),He._workerFarm.setProps(e),He._workerFarm}constructor(e){this.props={...xe},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:n}=e;let s=this.workerPools.get(t);return s||(s=new Ue({name:t,source:r,url:n}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}const Le=(globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version);async function Se(e,t,r,n,s){const o=e.id,i=function(e,t={}){const r=t[e.id]||{},n=Ee?`${e.id}-worker.js`:`${e.id}-worker-node.js`;let s=r.workerUrl;if(s||"compression"!==e.id||(s=t.workerUrl),"test"===t._workerType&&(s=Ee?`modules/${e.module}/dist/${n}`:`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!s){let t=e.version;"latest"===t&&(t="latest");const r=t?`@${t}`:"";s=`https://unpkg.com/@loaders.gl/${e.module}${r}/dist/${n}`}return we(s),s}(e,r),a=He.getWorkerFarm(r).getWorkerPool({name:o,url:i});r=JSON.parse(JSON.stringify(r)),n=JSON.parse(JSON.stringify(n||{}));const c=await a.startJob("process-on-worker",je.bind(null,s));c.postMessage("process",{input:t,options:r,context:n});const u=await c.result;return await u.result}async function je(e,t,r,n){switch(r){case"done":t.done(n);break;case"error":t.error(new Error(n.error));break;case"process":const{id:s,input:o,options:i}=n;try{const r=await e(o,i);t.postMessage("done",{id:s,result:r})}catch(e){const r=e instanceof Error?e.message:"unknown error";t.postMessage("error",{id:s,error:r})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function Pe(e,t,r){const n=void 0!==r?new Uint8Array(e).subarray(t,t+r):new Uint8Array(e).subarray(t);return new Uint8Array(n).buffer}const Ne=262144;function Ke(e){if((t=e)&&"object"==typeof t&&t.isBuffer)return e;var t;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if("string"==typeof e){const t=e;return(new TextEncoder).encode(t).buffer}if(e&&"object"==typeof e&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function ke(e,t){return ue?async function*(e,t){const r=e.getReader();let n;try{for(;;){const e=n||r.read();t?._streamReadAhead&&(n=r.read());const{done:s,value:o}=await e;if(s)return;yield Ke(o)}}catch(e){r.releaseLock()}}(e,t):async function*(e){for await(const t of e)yield Ke(t)}(e)}const Qe="Cannot convert supplied data type";async function Xe(e,t,r){const n=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if("string"==typeof e||n)return function(e,t){if(t.text&&"string"==typeof e)return e;var r;if((r=e)&&"object"==typeof r&&r.isBuffer&&(e=e.buffer),e instanceof ArrayBuffer){const r=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let r=e.buffer;const n=e.byteLength||e.length;return 0===e.byteOffset&&n===r.byteLength||(r=r.slice(e.byteOffset,e.byteOffset+n)),r}throw new Error(Qe)}(e,t);if(M(e)&&(e=await P(e)),G(e)){const r=e;return await async function(e){if(!e.ok){const t=await async function(e){const t=function(e){if(e.length<50)return e;const t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}(e.url);let r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${t}`;r=r.length>100?`${r.slice(0,100)}...`:r;const n={reason:e.statusText,url:e.url,response:e};try{const t=e.headers.get("Content-Type");n.reason=!e.bodyUsed&&t?.includes("application/json")?await e.json():await e.text()}catch(e){}return new _(r,n)}(e);throw t}}(r),t.binary?await r.arrayBuffer():await r.text()}if(w(e)&&(e=function(e,t){if("string"==typeof e)return function*(e,t){const r=t?.chunkSize||262144;let n=0;const s=new TextEncoder;for(;n<e.length;){const t=Math.min(e.length-n,r),o=e.slice(n,n+t);n+=t,yield s.encode(o)}}(e,t);if(e instanceof ArrayBuffer)return function*(e,t={}){const{chunkSize:r=Ne}=t;let n=0;for(;n<e.byteLength;){const t=Math.min(e.byteLength-n,r),s=new ArrayBuffer(t),o=new Uint8Array(e,n,t);new Uint8Array(s).set(o),n+=t,yield s}}(e,t);if(M(e))return async function*(e,t){const r=t?.chunkSize||1048576;let n=0;for(;n<e.size;){const t=n+r,s=await e.slice(n,t).arrayBuffer();n=t,yield s}}(e,t);if(w(e))return ke(e,t);if(G(e))return ke(e.body,t);throw new Error("makeIterator")}(e,r)),s=e,Boolean(s)&&"function"==typeof s[Symbol.iterator]||(e=>e&&"function"==typeof e[Symbol.asyncIterator])(e))return async function(e){const t=[];for await(const r of e)t.push(r);return function(...e){return function(e){const t=e.map((e=>e instanceof ArrayBuffer?new Uint8Array(e):e)),r=t.reduce(((e,t)=>e+t.byteLength),0),n=new Uint8Array(r);let s=0;for(const e of t)n.set(e,s),s+=e.byteLength;return n.buffer}(e)}(...t)}(e);var s;throw new Error(Qe)}function Ye(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}const We="4.3.2",Ve=We[0]>="0"&&We[0]<="9"?`v${We}`:"",Ze=function(){const e=new ne({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=e,globalThis.loaders.version=Ve,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=e,e}(),qe=/\.([^.]+)$/;function $e(e,t=[],r,n){if(!ze(e))return null;if(t&&!Array.isArray(t))return T(t);let s=[];t&&(s=s.concat(t)),r?.ignoreRegisteredLoaders||s.push(...(()=>{const e=he();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry})()),function(e){for(const t of e)T(t)}(s);const o=function(e,t,r,n){const s=S(e),o=j(e),i=L(s)||n?.url;let a=null,c="";return r?.mimeType&&(a=tt(t,r?.mimeType),c=`match forced by supplied MIME type ${r?.mimeType}`),a=a||function(e,t){const r=t&&qe.exec(t),n=r&&r[1];return n?function(e,t){t=t.toLowerCase();for(const r of e)for(const e of r.extensions)if(e.toLowerCase()===t)return r;return null}(e,n):null}(t,i),c=c||(a?`matched url ${i}`:""),a=a||tt(t,o),c=c||(a?`matched MIME type ${o}`:""),a=a||function(e,t){if(!t)return null;for(const r of e)if("string"==typeof t){if(rt(t,r))return r}else if(ArrayBuffer.isView(t)){if(nt(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&nt(t,0,r))return r;return null}(t,e),c=c||(a?`matched initial data ${st(e)}`:""),r?.fallbackMimeType&&(a=a||tt(t,r?.fallbackMimeType),c=c||(a?`matched fallback MIME type ${o}`:"")),c&&Ze.log(1,`selectLoader selected ${a?.name}: ${c}.`),a}(e,s,r,n);if(!o&&!r?.nothrow)throw new Error(et(e));return o}function ze(e){return!(e instanceof Response&&204===e.status)}function et(e){const t=S(e),r=j(e);let n="No valid loader found (";n+=t?`${Ye(t)}, `:"no url provided, ",n+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const s=e?st(e):"";return n+=s?` first bytes: "${s}"`:"first bytes: not available",n+=")",n}function tt(e,t){for(const r of e){if(r.mimeTypes?.some((e=>U(t,e))))return r;if(U(t,`application/x.${r.id}`))return r}return null}function rt(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some((t=>e.startsWith(t)))}function nt(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some((r=>function(e,t,r,n){if(n instanceof ArrayBuffer)return function(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;const n=new Uint8Array(e),s=new Uint8Array(t);for(let e=0;e<n.length;++e)if(n[e]!==s[e])return!1;return!0}(n,e,n.byteLength);switch(typeof n){case"function":return n(e);case"string":return n===ot(e,t,n.length);default:return!1}}(e,t,0,r)))}function st(e,t=5){return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?ot(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?ot(e,0,t):""}function ot(e,t,r){if(e.byteLength<t+r)return"";const n=new DataView(e);let s="";for(let e=0;e<r;e++)s+=String.fromCharCode(n.getUint8(t+e));return s}async function it(e,t,r,n){!t||Array.isArray(t)||D(t)||(n=void 0,r=t,t=void 0),r=r||{};const s=S(e=await e),o=function(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const e=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...e]:e}return r&&r.length?r:void 0}(t,n),i=await async function(e,t=[],r,n){if(!ze(e))return null;let s=$e(e,t,{...r,nothrow:!0},n);if(s)return s;if(M(e)&&(s=$e(e=await e.slice(0,10).arrayBuffer(),t,r,n)),!s&&!r?.nothrow)throw new Error(et(e));return s}(e,o,r);return i?(n=function(e,t,r){if(r)return r;const n={fetch:be(t,e),...e};if(n.url){const e=L(n.url);n.baseUrl=e,n.queryString=function(e){const t=e.match(H);return t&&t[0]}(n.url),n.filename=Ye(e),n.baseUrl=function(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}(e)}return Array.isArray(n.loaders)||(n.loaders=null),n}({url:s,_parse:it,loaders:o},r=Be(r,i,o,s),n||null),await async function(e,t,r,n){if(function(e){we(e,"no worker provided");e.version}(e),r=ye(e.options,r),G(t)){const e=t,{ok:r,redirected:s,status:o,statusText:i,type:a,url:c}=e,u=Object.fromEntries(e.headers.entries());n.response={headers:u,ok:r,redirected:s,status:o,statusText:i,type:a,url:c}}t=await Xe(t,e,r);const s=e;if(s.parseTextSync&&"string"==typeof t)return s.parseTextSync(t,r,n);if(function(e,t){return!!He.isSupported()&&!(!Ee&&!t?._nodeWorkers)&&e.worker&&t?.worker}(e,r))return await Se(e,t,r,n,it);if(s.parseText&&"string"==typeof t)return await s.parseText(t,r,n);if(s.parse)return await s.parse(t,r,n);throw we(!s.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}(i,e,r,n)):null}function at(e,t,r){if(e.byteLength<=t+r)return"";const n=new DataView(e);let s="";for(let e=0;e<r;e++)s+=String.fromCharCode(n.getUint8(t+e));return s}async function ct(e,t,r,n){return n._parse(e,t,r,n)}const ut=globalThis.loaders?.parseImageNode,ft="undefined"!=typeof Image,At="undefined"!=typeof ImageBitmap,lt=Boolean(ut),ht=!!ue||lt;function dt(e){const t=function(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&e instanceof Image?"image":e&&"object"==typeof e&&e.data&&e.width&&e.height?"data":null}(e);if(!t)throw new Error("Not an image");return t}function Bt(e){switch(dt(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}const mt=/^data:image\/svg\+xml/,gt=/\.svg((\?|#).*)?$/;function Ct(e){return e&&(mt.test(e)||gt.test(e))}function bt(e,t){if(Ct(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function yt(e,t,r){const n=function(e,t){if(Ct(t)){let t=(new TextDecoder).decode(e);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(t=unescape(encodeURIComponent(t)))}catch(e){throw new Error(e.message)}return`data:image/svg+xml;base64,${btoa(t)}`}return bt(e,t)}(e,r),s=self.URL||self.webkitURL,o="string"!=typeof n&&s.createObjectURL(n);try{return await async function(e,t){const r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise(((e,t)=>{try{r.onload=()=>e(r),r.onerror=e=>{const r=e instanceof Error?e.message:"error";t(new Error(r))}}catch(e){t(e)}}))}(o||n,t)}finally{o&&s.revokeObjectURL(o)}}const pt={};let Et=!0;const Ft=!1,It=!0;function Gt(e){const t=Mt(e);return function(e){const t=Mt(e);return t.byteLength>=24&&2303741511===t.getUint32(0,Ft)?{mimeType:"image/png",width:t.getUint32(16,Ft),height:t.getUint32(20,Ft)}:null}(t)||function(e){const t=Mt(e);if(!(t.byteLength>=3&&65496===t.getUint16(0,Ft)&&255===t.getUint8(2)))return null;const{tableMarkers:r,sofMarkers:n}=function(){const e=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)e.add(t);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let s=2;for(;s+9<t.byteLength;){const e=t.getUint16(s,Ft);if(n.has(e))return{mimeType:"image/jpeg",height:t.getUint16(s+5,Ft),width:t.getUint16(s+7,Ft)};if(!r.has(e))return null;s+=2,s+=t.getUint16(s,Ft)}return null}(t)||function(e){const t=Mt(e);return t.byteLength>=10&&1195984440===t.getUint32(0,Ft)?{mimeType:"image/gif",width:t.getUint16(6,It),height:t.getUint16(8,It)}:null}(t)||function(e){const t=Mt(e);return t.byteLength>=14&&16973===t.getUint16(0,Ft)&&t.getUint32(2,It)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,It),height:t.getUint32(22,It)}:null}(t)||function(e){const t=function(e){return function(e,t,r=0){const n=(s="ftyp",[...s].map((e=>e.charCodeAt(0))));var s;for(let t=0;t<n.length;++t)if(n[t]!==e[t+r])return!1;return!0}(e,0,4)&&96&e[8]?function(e){switch((t=e,String.fromCharCode(...t.slice(8,12))).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}var t}(e):null}(new Uint8Array(e instanceof DataView?e.buffer:e));return t?{mimeType:t.mimeType,width:0,height:0}:null}(t)}function Mt(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}const wt={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:"4.3.2",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],parse:async function(e,t,r){const n=((t=t||{}).image||{}).type||"auto",{url:s}=r||{};let o;switch(function(e){switch(e){case"auto":case"data":return function(){if(At)return"imagebitmap";if(ft)return"image";if(ht)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(e){switch(e){case"auto":return At||ft||ht;case"imagebitmap":return At;case"image":return ft;case"data":return ht;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}(e),e}}(n)){case"imagebitmap":o=await async function(e,t,r){let n;n=Ct(r)?await yt(e,t,r):bt(e,r);const s=t&&t.imagebitmap;return await async function(e,t=null){if(!function(e){for(const t in e||pt)return!1;return!0}(t)&&Et||(t=null),t)try{return await createImageBitmap(e,t)}catch(e){console.warn(e),Et=!1}return await createImageBitmap(e)}(n,s)}(e,t,s);break;case"image":o=await yt(e,t,s);break;case"data":o=await async function(e){const{mimeType:t}=Gt(e)||{},r=globalThis.loaders?.parseImageNode;return v(r),await r(e,t)}(e);break;default:v(!1)}return"data"===n&&(o=Bt(o)),o},tests:[e=>Boolean(Gt(new DataView(e)))],options:{image:{type:"auto",decode:!0}}},vt={};async function Dt(e,t=null,r={},n=null){return t&&(e=function(e,t,r={},n=null){if(!r.useLocalLibraries&&e.startsWith("http"))return e;n=n||e;const s=r.modules||{};return s[n]?s[n]:Ee?r.CDN?(we(r.CDN.startsWith("http")),`${r.CDN}/${t}@${Le}/dist/libs/${n}`):Fe?`../src/libs/${n}`:`modules/${t}/src/libs/${n}`:`modules/${t}/dist/libs/${n}`}(e,t,r,n)),vt[e]=vt[e]||async function(e){if(e.endsWith("wasm"))return await async function(e){const{readFileAsArrayBuffer:t}=globalThis.loaders||{};if(Ee||!t||e.startsWith("http")){const t=await fetch(e);return await t.arrayBuffer()}return await t(e)}(e);if(!Ee)try{const{requireFromFile:t}=globalThis.loaders||{};return await(t?.(e))}catch(e){return console.error(e),null}if(Fe)return importScripts(e);return function(e,t){if(!Ee){const{requireFromString:r}=globalThis.loaders||{};return r?.(e,t)}if(Fe)return eval.call(globalThis,e),null;const r=document.createElement("script");r.id=t;try{r.appendChild(document.createTextNode(e))}catch(t){r.text=e}return document.body.appendChild(r),null}(await async function(e){const{readFileAsText:t}=globalThis.loaders||{};if(Ee||!t||e.startsWith("http")){const t=await fetch(e);return await t.text()}return await t(e)}(e),e)}(e),await vt[e]}let Tt,Rt;async function _t(e){var t;t=e.modules,globalThis.loaders||={},globalThis.loaders.modules||={},Object.assign(globalThis.loaders.modules,t);return function(){const e=globalThis.loaders?.modules?.basis;return e||null}()||(Tt||=async function(e){let t=null,r=null;return[t,r]=await Promise.all([await Dt("basis_transcoder.js","textures",e),await Dt("basis_transcoder.wasm","textures",e)]),t=t||globalThis.BASIS,await function(e,t){const r={};return t&&(r.wasmBinary=t),new Promise((t=>{e(r).then((e=>{const{BasisFile:r,initializeBasis:n}=e;n(),t({BasisFile:r})}))}))}(t,r)}(e),await Tt)}async function Jt(e){const t=e.modules||{};return t.basisEncoder?t.basisEncoder:(Rt=Rt||async function(e){let t=null,r=null;return[t,r]=await Promise.all([await Dt("basis_encoder.js","textures",e),await Dt("basis_encoder.wasm","textures",e)]),t=t||globalThis.BASIS,await function(e,t){const r={};return t&&(r.wasmBinary=t),new Promise((t=>{e(r).then((e=>{const{BasisFile:r,KTX2File:n,initializeBasis:s,BasisEncoder:o}=e;s(),t({BasisFile:r,KTX2File:n,BasisEncoder:o})}))}))}(t,r)}(e),await Rt)}const Ot=["","WEBKIT_","MOZ_"],Ut={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let xt=null;const Ht=[171,75,84,88,32,50,48,187,13,10,26,10],Lt={etc1:{basisFormat:0,compressed:!0,format:36196},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:33776},bc3:{basisFormat:3,compressed:!0,format:33779},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:35840},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:35842},"astc-4x4":{basisFormat:10,compressed:!0,format:37808},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};function St(e,t,r){const n=new e(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("Failed to start basis transcoding");const e=n.getNumImages(),t=[];for(let s=0;s<e;s++){const e=n.getNumLevels(s),o=[];for(let t=0;t<e;t++)o.push(jt(n,s,t,r));t.push(o)}return t}finally{n.close(),n.delete()}}function jt(e,t,r,n){const s=e.getImageWidth(t,r),o=e.getImageHeight(t,r),i=e.getHasAlpha(),{compressed:a,format:c,basisFormat:u}=Kt(n,i),f=e.getImageTranscodedSizeInBytes(t,r,u),A=new Uint8Array(f);if(!e.transcodeImage(A,t,r,u,0,0))throw new Error("failed to start Basis transcoding");return{width:s,height:o,data:A,compressed:a,format:c,hasAlpha:i}}function Pt(e,t,r){const n=new e(new Uint8Array(t));try{if(!n.startTranscoding())throw new Error("failed to start KTX2 transcoding");const e=n.getLevels(),t=[];for(let s=0;s<e;s++)t.push(Nt(n,s,r));return[t]}finally{n.close(),n.delete()}}function Nt(e,t,r){const{alphaFlag:n,height:s,width:o}=e.getImageLevelInfo(t,0,0),{compressed:i,format:a,basisFormat:c}=Kt(r,n),u=e.getImageTranscodedSizeInBytes(t,0,0,c),f=new Uint8Array(u);if(!e.transcodeImage(f,t,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:s,data:f,compressed:i,levelSize:u,hasAlpha:n,format:a}}function Kt(e,t){let r=e&&e.basis&&e.basis.format;return"auto"===r&&(r=kt()),"object"==typeof r&&(r=t?r.alpha:r.noAlpha),r=r.toLowerCase(),Lt[r]}function kt(){const e=function(e){if(!xt){e=e||function(){try{return document.createElement("canvas").getContext("webgl")}catch(e){return null}}()||void 0,xt=new Set;for(const t of Ot)for(const r in Ut)if(e&&e.getExtension(`${t}${r}`)){const e=Ut[r];xt.add(e)}}return xt}();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}const Qt={dataType:null,batchType:null,name:"Basis",id:"basis",module:"textures",version:"4.3.2",worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}},parse:async function(e,t){if("auto"===t.basis.containerFormat){if(function(e){const t=new Uint8Array(e);return!(t.byteLength<Ht.length||t[0]!==Ht[0]||t[1]!==Ht[1]||t[2]!==Ht[2]||t[3]!==Ht[3]||t[4]!==Ht[4]||t[5]!==Ht[5]||t[6]!==Ht[6]||t[7]!==Ht[7]||t[8]!==Ht[8]||t[9]!==Ht[9]||t[10]!==Ht[10]||t[11]!==Ht[11])}(e))return Pt((await Jt(t)).KTX2File,e,t);const{BasisFile:r}=await _t(t);return St(r,e,t)}if("encoder"===t.basis.module){const r=await Jt(t);return"ktx2"===t.basis.containerFormat?Pt(r.KTX2File,e,t):St(r.BasisFile,e,t)}{const{BasisFile:r}=await _t(t);return St(r,e,t)}}};function Xt(e,t){if(!e)throw new Error(t||"assert failed: gltf")}function Yt(e,t){return v(e>=0),v(t>0),e+(t-1)&~(t-1)}function Wt(e,t,r){let n;if(e instanceof ArrayBuffer)n=new Uint8Array(e);else{const t=e.byteOffset,r=e.byteLength;n=new Uint8Array(e.buffer||e.arrayBuffer,t,r)}return t.set(n,r),r+Yt(n.byteLength,4)}const Vt=!0,Zt=1735152710;function qt(e,t,r,n){const s=new Uint8Array(t.buffer,r,n),o=new TextDecoder("utf8").decode(s);return e.json=JSON.parse(o),Yt(n,4)}function $t(e,t,r,n){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:r,byteLength:n,arrayBuffer:t.buffer}),Yt(n,4)}function zt(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;const r=t.baseUri||t.uri;if(!r)throw new Error(`'baseUri' must be provided to resolve relative url ${e}`);return r.substr(0,r.lastIndexOf("/")+1)+e}const er={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},tr={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},rr=["SCALAR","VEC2","VEC3","VEC4"],nr=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],sr=new Map(nr),or={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ir={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},ar={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function cr(e){return rr[e-1]||rr[0]}function ur(e){const t=sr.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function fr(e,t){const r=ar[e.componentType],n=or[e.type],s=ir[e.componentType],o=e.count*n,i=e.count*n*s;return Xt(i>=0&&i<=t.byteLength),{ArrayType:r,length:o,byteLength:i,componentByteSize:tr[e.componentType],numberOfComponentsInElement:er[e.type]}}class Ar{gltf;sourceBuffers;byteLength;constructor(e){this.gltf={json:e?.json||{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]},buffers:e?.buffers||[],images:e?.images||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}hasExtension(e){const t=this.getUsedExtensions().find((t=>t===e)),r=this.getRequiredExtensions().find((t=>t===e));return"string"==typeof t||"string"==typeof r}getExtension(e){const t=this.getUsedExtensions().find((t=>t===e)),r=this.json.extensions||{};return t?r[e]:null}getRequiredExtension(e){return this.getRequiredExtensions().find((t=>t===e))?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,t){return(e.extensions||{})[t]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,t){if("object"==typeof t)return t;const r=this.json[e]&&this.json[e][t];if(!r)throw new Error(`glTF file error: Could not find ${e}[${t}]`);return r}getTypedArrayForBufferView(e){const t=(e=this.getBufferView(e)).buffer,r=this.gltf.buffers[t];Xt(r);const n=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,n,e.byteLength)}getTypedArrayForAccessor(e){const t=this.getAccessor(e);return function(e,t,r){const n="number"==typeof r?e.accessors?.[r]:r;if(!n)throw new Error(`No gltf accessor ${JSON.stringify(r)}`);const s=e.bufferViews?.[n.bufferView||0];if(!s)throw new Error(`No gltf buffer view for accessor ${s}`);const{arrayBuffer:o,byteOffset:i}=t[s.buffer],a=(i||0)+(n.byteOffset||0)+(s.byteOffset||0),{ArrayType:c,length:u,componentByteSize:f,numberOfComponentsInElement:A}=fr(n,s),l=f*A,h=s.byteStride||l;if(void 0===s.byteStride||s.byteStride===l)return new c(o,a,u);const d=new c(u);for(let e=0;e<n.count;e++){const t=new c(o,a+e*h,A);d.set(t,e*A)}return d}(this.gltf.json,this.gltf.buffers,t)}getTypedArrayForImageData(e){e=this.getAccessor(e);const t=this.getBufferView(e.bufferView),r=this.getBuffer(t.buffer).data,n=t.byteOffset||0;return new Uint8Array(r,n,t.byteLength)}addApplicationData(e,t){return this.json[e]=t,this}addExtraData(e,t){return this.json.extras=this.json.extras||{},this.json.extras[e]=t,this}addObjectExtension(e,t,r){return e.extensions=e.extensions||{},e.extensions[t]=r,this.registerUsedExtension(t),this}setObjectExtension(e,t,r){(e.extensions||{})[t]=r}removeObjectExtension(e,t){const r=e?.extensions||{};if(r[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const e=this.json.extensionsRemoved;e.includes(t)||e.push(t)}delete r[t]}addExtension(e,t={}){return Xt(t),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=t,this.registerUsedExtension(e),t}addRequiredExtension(e,t={}){return Xt(t),this.addExtension(e,t),this.registerRequiredExtension(e),t}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find((t=>t===e))||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find((t=>t===e))||this.json.extensionsRequired.push(e)}removeExtension(e){if(this.json.extensions?.[e]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const t=this.json.extensionsRemoved;t.includes(e)||t.push(e)}this.json.extensions&&delete this.json.extensions[e],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:t}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:t}),this.json.scenes.length-1}addNode(e){const{meshIndex:t,matrix:r}=e;this.json.nodes=this.json.nodes||[];const n={mesh:t};return r&&(n.matrix=r),this.json.nodes.push(n),this.json.nodes.length-1}addMesh(e){const{attributes:t,indices:r,material:n,mode:s=4}=e,o={primitives:[{attributes:this._addAttributes(t),mode:s}]};if(r){const e=this._addIndices(r);o.primitives[0].indices=e}return Number.isFinite(n)&&(o.primitives[0].material=n),this.json.meshes=this.json.meshes||[],this.json.meshes.push(o),this.json.meshes.length-1}addPointCloud(e){const t={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(t),this.json.meshes.length-1}addImage(e,t){const r=Gt(e),n=t||r?.mimeType,s={bufferView:this.addBufferView(e),mimeType:n};return this.json.images=this.json.images||[],this.json.images.push(s),this.json.images.length-1}addBufferView(e,t=0,r=this.byteLength){const n=e.byteLength;Xt(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const s={buffer:t,byteOffset:r,byteLength:n};return this.byteLength+=Yt(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(s),this.json.bufferViews.length-1}addAccessor(e,t){const r={bufferView:e,type:cr(t.size),componentType:t.componentType,count:t.count,max:t.max,min:t.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e,t={size:3}){const r=this.addBufferView(e);let n={min:t.min,max:t.max};n.min&&n.max||(n=this._getAccessorMinMax(e,t.size));const s={size:t.size,componentType:ur(e),count:Math.round(e.length/t.size),min:n.min,max:n.max};return this.addAccessor(r,Object.assign(s,t))}addTexture(e){const{imageIndex:t}=e,r={source:t};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){const e=this.byteLength,t=new ArrayBuffer(e),r=new Uint8Array(t);let n=0;for(const e of this.sourceBuffers||[])n=Wt(e,r,n);this.json?.buffers?.[0]?this.json.buffers[0].byteLength=e:this.json.buffers=[{byteLength:e}],this.gltf.binary=t,this.sourceBuffers=[t],this.gltf.buffers=[{arrayBuffer:t,byteOffset:0,byteLength:t.byteLength}]}_removeStringFromArray(e,t){let r=!0;for(;r;){const n=e.indexOf(t);n>-1?e.splice(n,1):r=!1}}_addAttributes(e={}){const t={};for(const r in e){const n=e[r],s=this._getGltfAttributeName(r),o=this.addBinaryBuffer(n.value,n);t[s]=o}return t}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,t){const r={min:null,max:null};if(e.length<t)return r;r.min=[],r.max=[];const n=e.subarray(0,t);for(const e of n)r.min.push(e),r.max.push(e);for(let n=t;n<e.length;n+=t)for(let s=0;s<t;s++)r.min[0+s]=Math.min(r.min[0+s],e[n+s]),r.max[0+s]=Math.max(r.max[0+s],e[n+s]);return r}}function lr(e){return(e%1+1)%1}const hr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},dr={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},Br={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function mr(e,t){return Br[t]*hr[e]}function gr(e,t,r,n){if("UINT8"!==r&&"UINT16"!==r&&"UINT32"!==r&&"UINT64"!==r)return null;const s=Cr(e.getTypedArrayForBufferView(t),"SCALAR",r,n+1);return s instanceof BigInt64Array||s instanceof BigUint64Array?null:s}function Cr(e,t,r,n=1){const s=hr[t],o=dr[r],i=Br[r],a=n*s,c=a*i;let u=e.buffer,f=e.byteOffset;return f%i!=0&&(u=new Uint8Array(u).slice(f,f+c).buffer,f=0),new o(u,f,a)}function br(e,t,r){const n=`TEXCOORD_${t.texCoord||0}`,s=r.attributes[n],o=e.getTypedArrayForAccessor(s),i=e.gltf.json,a=t.index,c=i.textures?.[a]?.source;if(void 0!==c){const r=i.images?.[c]?.mimeType,n=e.gltf.images?.[c];if(n&&void 0!==n.width){const e=[];for(let s=0;s<o.length;s+=2){const i=pr(n,r,o,s,t.channels);e.push(i)}return e}}return[]}function yr(e,t,r,n,s){if(!r?.length)return;const o=[];for(const e of r){let t=n.findIndex((t=>t===e));-1===t&&(t=n.push(e)-1),o.push(t)}const i=new Uint32Array(o),a=e.gltf.buffers.push({arrayBuffer:i.buffer,byteOffset:i.byteOffset,byteLength:i.byteLength})-1,c=e.addBufferView(i,a,0),u=e.addAccessor(c,{size:1,componentType:ur(i),count:i.length});s.attributes[t]=u}function pr(e,t,r,n,s=[0]){const o={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},i=r[n],a=r[n+1];let c=1;!t||-1===t.indexOf("image/jpeg")&&-1===t.indexOf("image/png")||(c=4);const u=function(e,t,r,n=1){const s=r.width,o=lr(e)*(s-1),i=Math.round(o),a=r.height,c=lr(t)*(a-1);return(Math.round(c)*s+i)*(r.components?r.components:n)}(i,a,e,c);let f=0;for(const t of s){const r="number"==typeof t?Object.values(o)[t]:o[t],n=u+r.offset,s=Bt(e);if(s.data.length<=n)throw new Error(`${s.data.length} <= ${n}`);f|=s.data[n]<<r.shift}return f}function Er(e,t,r,n,s){const o=[];for(let i=0;i<t;i++){const t=r[i],a=r[i+1]-r[i];if(a+t>n)break;const c=t/s,u=a/s;o.push(e.slice(c,c+u))}return o}function Fr(e,t,r){const n=[];for(let s=0;s<t;s++){const t=s*r;n.push(e.slice(t,t+r))}return n}function Ir(e,t,r,n){if(r)throw new Error("Not implemented - arrayOffsets for strings is specified");if(n){const r=[],s=new TextDecoder("utf8");let o=0;for(let i=0;i<e;i++){const e=n[i+1]-n[i];if(e+o<=t.length){const n=t.subarray(o,e+o),i=s.decode(n);r.push(i),o+=e}}return r}return[]}const Gr="EXT_mesh_features",Mr=Gr;async function wr(e,t){!function(e,t){const r=e.gltf.json;if(r.meshes)for(const n of r.meshes)for(const r of n.primitives)Dr(e,r,t)}(new Ar(e),t)}function vr(e,t){const r=new Ar(e);return function(e){const t=e.gltf.json.meshes;if(t)for(const r of t)for(const t of r.primitives)Rr(e,t)}(r),r.createBinaryChunk(),r.gltf}function Dr(e,t,r){if(!r?.gltf?.loadBuffers)return;const n=t.extensions?.[Gr],s=n?.featureIds;if(s)for(const n of s){let s;if(void 0!==n.attribute){const r=`_FEATURE_ID_${n.attribute}`,o=t.attributes[r];s=e.getTypedArrayForAccessor(o)}else s=void 0!==n.texture&&r?.gltf?.loadImages?br(e,n.texture,t):[];n.data=s}}function Tr(e,t,r,n){t.extensions||(t.extensions={});let s=t.extensions[Gr];s||(s={featureIds:[]},t.extensions[Gr]=s);const{featureIds:o}=s,i={featureCount:r.length,propertyTable:n,data:r};o.push(i),e.addObjectExtension(t,Gr,s)}function Rr(e,t){const r=t.extensions?.[Gr];if(!r)return;const n=r.featureIds;n.forEach(((r,s)=>{if(r.data){const{accessorKey:o,index:i}=function(e){const t="_FEATURE_ID_",r=Object.keys(e).filter((e=>0===e.indexOf(t)));let n=-1;for(const e of r){const t=Number(e.substring(12));t>n&&(n=t)}n++;return{accessorKey:`${t}${n}`,index:n}}(t.attributes),a=new Uint32Array(r.data);n[s]={featureCount:a.length,propertyTable:r.propertyTable,attribute:i},e.gltf.buffers.push({arrayBuffer:a.buffer,byteOffset:a.byteOffset,byteLength:a.byteLength});const c=e.addBufferView(a),u=e.addAccessor(c,{size:1,componentType:ur(a),count:a.length});t.attributes[o]=u}}))}const _r="EXT_structural_metadata",Jr=_r;async function Or(e,t){!function(e,t){if(!t.gltf?.loadBuffers)return;const r=e.getExtension(_r);r&&(t.gltf?.loadImages&&function(e,t){const r=t.propertyTextures,n=e.gltf.json;if(r&&n.meshes)for(const s of n.meshes)for(const n of s.primitives)Hr(e,r,n,t)}(e,r),function(e,t){const r=t.schema;if(!r)return;const n=r.classes,s=t.propertyTables;if(n&&s)for(const t in n){const n=xr(s,t);n&&Sr(e,r,n)}}(e,r))}(new Ar(e),t)}function Ur(e,t){const r=new Ar(e);return function(e){const t=e.getExtension(_r);if(t&&t.propertyTables)for(const r of t.propertyTables){const n=r.class,s=t.schema?.classes?.[n];r.properties&&s&&kr(r,s,e)}}(r),r.createBinaryChunk(),r.gltf}function xr(e,t){for(const r of e)if(r.class===t)return r;return null}function Hr(e,t,r,n){if(!t)return;const s=r.extensions?.[_r],o=s?.propertyTextures;if(o)for(const s of o)Lr(e,t[s],r,n)}function Lr(e,t,r,n){if(!t.properties)return;n.dataAttributeNames||(n.dataAttributeNames=[]);const s=t.class;for(const o in t.properties){const i=`${s}_${o}`,a=t.properties?.[o];if(!a)continue;a.data||(a.data=[]);const c=a.data,u=br(e,a,r);null!==u&&(yr(e,i,u,c,r),a.data=c,n.dataAttributeNames.push(i))}}function Sr(e,t,r){const n=t.classes?.[r.class];if(!n)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${r.class}`);const s=r.count;for(const o in n.properties){const i=n.properties[o],a=r.properties?.[o];if(a){const r=jr(e,t,i,s,a);a.data=r}}}function jr(e,t,r,n,s){let o=[];const i=s.values,a=e.getTypedArrayForBufferView(i),c=function(e,t,r,n){return t.array&&void 0===t.count&&void 0!==r.arrayOffsets?gr(e,r.arrayOffsets,r.arrayOffsetType||"UINT32",n):null}(e,r,s,n),u=function(e,t,r){return void 0!==t.stringOffsets?gr(e,t.stringOffsets,t.stringOffsetType||"UINT32",r):null}(e,s,n);switch(r.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":o=function(e,t,r,n){const s=e.array,o=e.count,i=mr(e.type,e.componentType),a=r.byteLength/i;let c;return c=e.componentType?Cr(r,e.type,e.componentType,a):r,s?n?Er(c,t,n,r.length,i):o?Fr(c,t,o):[]:c}(r,n,a,c);break;case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${r.type}`);case"STRING":o=Ir(n,a,c,u);break;case"ENUM":o=function(e,t,r,n,s){const o=t.enumType;if(!o)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const i=e.enums?.[o];if(!i)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${o}`);const a=i.valueType||"UINT16",c=mr(t.type,a),u=n.byteLength/c;let f=Cr(n,t.type,a,u);if(f||(f=n),t.array){if(s)return function(e){const{valuesData:t,numberOfElements:r,arrayOffsets:n,valuesDataBytesLength:s,elementSize:o,enumEntry:i}=e,a=[];for(let e=0;e<r;e++){const r=n[e],c=n[e+1]-n[e];if(c+r>s)break;const u=Pr(t,r/o,c/o,i);a.push(u)}return a}({valuesData:f,numberOfElements:r,arrayOffsets:s,valuesDataBytesLength:n.length,elementSize:c,enumEntry:i});const e=t.count;return e?function(e,t,r,n){const s=[];for(let o=0;o<t;o++){const t=Pr(e,r*o,r,n);s.push(t)}return s}(f,r,e,i):[]}return Pr(f,0,r,i)}(t,r,n,a,c);break;default:throw new Error(`Unknown classProperty type ${r.type}`)}return o}function Pr(e,t,r,n){const s=[];for(let o=0;o<r;o++)if(e instanceof BigInt64Array||e instanceof BigUint64Array)s.push("");else{const r=Nr(n,e[t+o]);r?s.push(r.name):s.push("")}return s}function Nr(e,t){for(const r of e.values)if(r.value===t)return r;return null}const Kr="schemaClassId";function kr(e,t,r){for(const n in e.properties){const s=e.properties[n].data;if(s){const o=t.properties[n];if(o){const t=Xr(s,o,r);e.properties[n]=t}}}}function Qr(e,t,r=Kr){let n=e.getExtension(_r);n||(n=e.addExtension(_r)),n.schema=function(e,t,r){const n=r??{id:"schema_id"},s={properties:{}};for(const t of e){const e={type:t.elementType,componentType:t.componentType};s.properties[t.name]=e}return n.classes={},n.classes[t]=s,n}(t,r,n.schema);const s=function(e,t,r){const n={class:t,count:0};let s=0;const o=r.classes?.[t];for(const t of e){if(0===s&&(s=t.values.length),s!==t.values.length&&t.values.length)throw new Error("Illegal values in attributes");const e=o?.properties[t.name];e&&(n.properties||(n.properties={}),n.properties[t.name]={values:0,data:t.values})}return n.count=s,n}(t,r,n.schema);return n.propertyTables||(n.propertyTables=[]),n.propertyTables.push(s)-1}function Xr(e,t,r){const n={values:0};if("STRING"===t.type){const{stringData:t,stringOffsets:s}=function(e){const t=new TextEncoder,r=[];let n=0;for(const s of e){const e=t.encode(s);n+=e.length,r.push(e)}const s=new Uint8Array(n),o=[];let i=0;for(const e of r)s.set(e,i),o.push(i),i+=e.length;o.push(i);return{stringData:s,stringOffsets:new Uint32Array(o)}}(e);n.stringOffsets=Wr(s,r),n.values=Wr(t,r)}else if("SCALAR"===t.type&&t.componentType){const s=function(e,t){const r=[];for(const t of e)r.push(Number(t));const n=Yr[t];if(!n)throw new Error("Illegal component type");return new n(r)}(e,t.componentType);n.values=Wr(s,r)}return n}const Yr={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:Int32Array,UINT64:Uint32Array,FLOAT32:Float32Array,FLOAT64:Float64Array};function Wr(e,t){return t.gltf.buffers.push({arrayBuffer:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength}),t.addBufferView(e)}const Vr="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",Zr="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",qr=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),$r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),zr={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},en={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};let tn;const rn="EXT_meshopt_compression",nn=rn;async function sn(e,t){const r=new Ar(e);if(!t?.gltf?.decompressMeshes||!t.gltf?.loadBuffers)return;const n=[];for(const t of e.json.bufferViews||[])n.push(on(r,t));await Promise.all(n),r.removeExtension(rn)}async function on(e,t){const r=e.getObjectExtension(t,rn);if(r){const{byteOffset:n=0,byteLength:s=0,byteStride:o,count:i,mode:a,filter:c="NONE",buffer:u}=r,f=e.gltf.buffers[u],A=new Uint8Array(f.arrayBuffer,f.byteOffset+n,s),l=new Uint8Array(e.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);await async function(e,t,r,n,s,o="NONE"){const i=await async function(){return tn||(tn=async function(){let e=Vr;WebAssembly.validate(qr)&&(e=Zr,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;++r){const n=e.charCodeAt(r);t[r]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let r=0;for(let n=0;n<e.length;++n)t[r++]=t[n]<60?$r[t[n]]:64*(t[n]-60)+t[++n];return t.buffer.slice(0,r)}(e),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}()),tn}();!function(e,t,r,n,s,o,i){const a=e.exports.sbrk,c=n+3&-4,u=a(c*s),f=a(o.length),A=new Uint8Array(e.exports.memory.buffer);A.set(o,f);const l=t(u,n,s,f,o.length);if(0===l&&i&&i(u,c,s),r.set(A.subarray(u,u+n*s)),a(u-a(0)),0!==l)throw new Error(`Malformed buffer data: ${l}`)}(i,i.exports[en[s]],e,t,r,n,i.exports[zr[o||"NONE"]])}(l,i,o,A,a,c),e.removeObjectExtension(t,rn)}}const an={};function cn(e){if(void 0===an[e]){const t=ue?function(e){switch(e){case"image/avif":case"image/webp":return function(e){try{return 0===document.createElement("canvas").toDataURL(e).indexOf(`data:${e}`)}catch{return!1}}(e);default:return!0}}(e):function(e){const t=globalThis.loaders?.imageFormatsNode||["image/png","image/jpeg","image/gif"],r=globalThis.loaders?.parseImageNode;return Boolean(r)&&t.includes(e)}(e);an[e]=t}return an[e]}const un="EXT_texture_webp",fn=un;function An(e,t){const r=new Ar(e);if(!cn("image/webp")){if(r.getRequiredExtensions().includes(un))throw new Error(`gltf: Required extension ${un} not supported by browser`);return}const{json:n}=r;for(const e of n.textures||[]){const t=r.getObjectExtension(e,un);t&&(e.source=t.source),r.removeObjectExtension(e,un)}r.removeExtension(un)}const ln="KHR_texture_basisu",hn=ln;function dn(e,t){const r=new Ar(e),{json:n}=r;for(const e of n.textures||[]){const t=r.getObjectExtension(e,ln);t&&(e.source=t.source,r.removeObjectExtension(e,ln))}r.removeExtension(ln)}const Bn={dataType:null,batchType:null,name:"Draco",id:"draco",module:"draco",version:"4.3.2",worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:"object"==typeof WebAssembly?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function mn(e,t,r){const n=function(e){switch(e.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}(t.value),s=r||function(e){const t={};return"byteOffset"in e&&(t.byteOffset=e.byteOffset.toString(10)),"byteStride"in e&&(t.byteStride=e.byteStride.toString(10)),"normalized"in e&&(t.normalized=e.normalized.toString()),t}(t);return{name:e,type:{type:"fixed-size-list",listSize:t.size,children:[{name:"value",type:n}]},nullable:!1,metadata:s}}function gn(e,t,r){return mn(e,t,r?Cn(r.metadata):void 0)}function Cn(e){Object.entries(e);const t={};for(const r in e)t[`${r}.string`]=JSON.stringify(e[r]);return t}const bn={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},yn={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array};class pn{draco;decoder;metadataQuerier;constructor(e){this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,t={}){const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(t);const n=this.decoder.GetEncodedGeometryType(r),s=n===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let e;switch(n){case this.draco.TRIANGULAR_MESH:e=this.decoder.DecodeBufferToMesh(r,s);break;case this.draco.POINT_CLOUD:e=this.decoder.DecodeBufferToPointCloud(r,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!e.ok()||!s.ptr){const t=`DRACO decompression failed: ${e.error_msg()}`;throw new Error(t)}const o=this._getDracoLoaderData(s,n,t),i=this._getMeshData(s,o,t),a=function(e){let t=1/0,r=1/0,n=1/0,s=-1/0,o=-1/0,i=-1/0;const a=e.POSITION?e.POSITION.value:[],c=a&&a.length;for(let e=0;e<c;e+=3){const c=a[e],u=a[e+1],f=a[e+2];t=c<t?c:t,r=u<r?u:r,n=f<n?f:n,s=c>s?c:s,o=u>o?u:o,i=f>i?f:i}return[[t,r,n],[s,o,i]]}(i.attributes),c=function(e,t,r){const n=Cn(t.metadata),s=[],o=function(e){const t={};for(const r in e){const n=e[r];t[n.name||"undefined"]=n}return t}(t.attributes);for(const t in e){const r=gn(t,e[t],o[t]);s.push(r)}if(r){const e=gn("indices",r);s.push(e)}return{fields:s,metadata:n}}(i.attributes,o,i.indices);return{loader:"draco",loaderData:o,header:{vertexCount:s.num_points(),boundingBox:a},...i,schema:c}}finally{this.draco.destroy(r),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,t,r){const n=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,r);return{geometry_type:t,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:n,attributes:s}}_getDracoAttributes(e,t){const r={};for(let n=0;n<e.num_attributes();n++){const s=this.decoder.GetAttribute(e,n),o=this._getAttributeMetadata(e,n);r[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:n,metadata:o};const i=this._getQuantizationTransform(s,t);i&&(r[s.unique_id()].quantization_transform=i);const a=this._getOctahedronTransform(s,t);a&&(r[s.unique_id()].octahedron_transform=a)}return r}_getMeshData(e,t,r){const n=this._getMeshAttributes(t,e,r);if(!n.POSITION)throw new Error("DRACO: No position attribute found.");return e instanceof this.draco.Mesh?"triangle-strip"===r.topology?{topology:"triangle-strip",mode:4,attributes:n,indices:{value:this._getTriangleStripIndices(e),size:1}}:{topology:"triangle-list",mode:5,attributes:n,indices:{value:this._getTriangleListIndices(e),size:1}}:{topology:"point-list",mode:0,attributes:n}}_getMeshAttributes(e,t,r){const n={};for(const s of Object.values(e.attributes)){const e=this._deduceAttributeName(s,r);s.name=e;const o=this._getAttributeValues(t,s);if(o){const{value:t,size:r}=o;n[e]={value:t,size:r,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}}return n}_getTriangleListIndices(e){const t=3*e.num_faces(),r=4*t,n=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,n),new Uint32Array(this.draco.HEAPF32.buffer,n,t).slice()}finally{this.draco._free(n)}}_getTriangleStripIndices(e){const t=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,t),function(e){const t=e.size(),r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=e.GetValue(n);return r}(t)}finally{this.draco.destroy(t)}}_getAttributeValues(e,t){const r=yn[t.data_type];if(!r)return console.warn(`DRACO: Unsupported attribute type ${t.data_type}`),null;const n=t.num_components,s=e.num_points()*n,o=s*r.BYTES_PER_ELEMENT,i=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}(this.draco,r);let a;const c=this.draco._malloc(o);try{const n=this.decoder.GetAttribute(e,t.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,n,i,o,c),a=new r(this.draco.HEAPF32.buffer,c,s).slice()}finally{this.draco._free(c)}return{value:a,size:n}}_deduceAttributeName(e,t){const r=e.unique_id;for(const[e,n]of Object.entries(t.extraAttributes||{}))if(n===r)return e;const n=e.attribute_type;for(const e in bn)if(this.draco[e]===n)return bn[e];const s=t.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:`CUSTOM_ATTRIBUTE_${r}`}_getTopLevelMetadata(e){const t=this.decoder.GetMetadata(e);return this._getDracoMetadata(t)}_getAttributeMetadata(e,t){const r=this.decoder.GetAttributeMetadata(e,t);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const t={},r=this.metadataQuerier.NumEntries(e);for(let n=0;n<r;n++){const r=this.metadataQuerier.GetEntryName(e,n);t[r]=this._getDracoMetadataField(e,r)}return t}_getDracoMetadataField(e,t){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,t,r);const n=function(e){const t=e.size(),r=new Int32Array(t);for(let n=0;n<t;n++)r[n]=e.GetValue(n);return r}(r);return{int:this.metadataQuerier.GetIntEntry(e,t),string:this.metadataQuerier.GetStringEntry(e,t),double:this.metadataQuerier.GetDoubleEntry(e,t),intArray:n}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:t=[],octahedronAttributes:r=[]}=e,n=[...t,...r];for(const e of n)this.decoder.SkipAttributeTransform(this.draco[e])}_getQuantizationTransform(e,t){const{quantizedAttributes:r=[]}=t,n=e.attribute_type();if(r.map((e=>this.decoder[e])).includes(n)){const t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits(),range:t.range(),min_values:new Float32Array([1,2,3]).map((e=>t.min_value(e)))}}finally{this.draco.destroy(t)}}return null}_getOctahedronTransform(e,t){const{octahedronAttributes:r=[]}=t,n=e.attribute_type();if(r.map((e=>this.decoder[e])).includes(n)){const t=new this.draco.AttributeQuantizationTransform;try{if(t.InitFromAttribute(e))return{quantization_bits:t.quantization_bits()}}finally{this.draco.destroy(t)}}return null}}const En="https://www.gstatic.com/draco/versioned/decoders/1.5.6",Fn="draco_wasm_wrapper.js",In="draco_decoder.wasm",Gn="draco_decoder.js",Mn="draco_encoder.js",wn={[Fn]:`${En}/${Fn}`,[In]:`${En}/${In}`,[Gn]:`${En}/${Gn}`,[Mn]:`https://raw.githubusercontent.com/google/draco/1.4.1/javascript/${Mn}`};let vn;const Dn={...Bn,parse:async function(e,t){const{draco:r}=await async function(e){const t=e.modules||{};return t.draco3d?vn||=t.draco3d.createDecoderModule({}).then((e=>({draco:e}))):vn||=async function(e){let t,r;return"js"===(e.draco&&e.draco.decoderType)?t=await Dt(wn[Gn],"draco",e,Gn):[t,r]=await Promise.all([await Dt(wn[Fn],"draco",e,Fn),await Dt(wn[In],"draco",e,In)]),t=t||globalThis.DracoDecoderModule,await function(e,t){const r={};return t&&(r.wasmBinary=t),new Promise((t=>{e({...r,onModuleLoaded:e=>t({draco:e})})}))}(t,r)}(e),await vn}(t),n=new pn(r);try{return n.parseSync(e,t?.draco)}finally{n.destroy()}}};function Tn(e){const{buffer:t,size:r,count:n}=function(e){let t=e,r=1,n=0;return e&&e.value&&(t=e.value,r=e.size||1),t&&(ArrayBuffer.isView(t)||(t=function(e,t,r=!1){return e?Array.isArray(e)?new t(e):!r||e instanceof t?e:new t(e):null}(t,Float32Array)),n=t.length/r),{buffer:t,size:r,count:n}}(e);return{value:t,size:r,byteOffset:0,count:n,type:cr(r),componentType:ur(t)}}const Rn="KHR_draco_mesh_compression",_n=Rn;function Jn(e,t,r){const n=new Ar(e);for(const e of Ln(n))n.getObjectExtension(e,Rn)}async function On(e,t,r){if(!t?.gltf?.decompressMeshes)return;const n=new Ar(e),s=[];for(const e of Ln(n))n.getObjectExtension(e,Rn)&&s.push(xn(n,e,t,r));await Promise.all(s),n.removeExtension(Rn)}function Un(e,t={}){const r=new Ar(e);for(const e of r.json.meshes||[])Hn(e),r.addRequiredExtension(Rn)}async function xn(e,t,r,n){const s=e.getObjectExtension(t,Rn);if(!s)return;const o=e.getTypedArrayForBufferView(s.bufferView),i=Pe(o.buffer,o.byteOffset),a={...r};delete a["3d-tiles"];const c=await ct(i,Dn,a,n),u=function(e){const t={};for(const r in e){const n=e[r];if("indices"!==r){const e=Tn(n);t[r]=e}}return t}(c.attributes);for(const[r,n]of Object.entries(u))if(r in t.attributes){const s=t.attributes[r],o=e.getAccessor(s);o?.min&&o?.max&&(n.min=o.min,n.max=o.max)}t.attributes=u,c.indices&&(t.indices=Tn(c.indices)),e.removeObjectExtension(t,Rn),function(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}(t)}function Hn(e,t,r=4,n,s){if(!n.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=n.DracoWriter.encodeSync({attributes:e}),i=s?.parseSync?.({attributes:e}),a=n._addFauxAttributes(i.attributes),c=n.addBufferView(o);return{primitives:[{attributes:a,mode:r,extensions:{[Rn]:{bufferView:c,attributes:a}}}]}}function*Ln(e){for(const t of e.json.meshes||[])for(const e of t.primitives)yield e}Math.PI,Math.PI,globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};const Sn=globalThis.mathgl.config;function jn(e,{precision:t=Sn.precision}={}){return e=function(e){return Math.round(e/Sn.EPSILON)*Sn.EPSILON}(e),`${parseFloat(e.toPrecision(t))}`}function Pn(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Nn(e,t,r){const n=Sn.EPSILON;r&&(Sn.EPSILON=r);try{if(e===t)return!0;if(Pn(e)&&Pn(t)){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(!Nn(e[r],t[r]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):"number"==typeof e&&"number"==typeof t&&Math.abs(e-t)<=Sn.EPSILON*Math.max(1,Math.abs(e),Math.abs(t))}finally{Sn.EPSILON=n}}class Kn extends Array{clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}toArray(e=[],t=0){for(let r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Pn(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Sn)}formatString(e){let t="";for(let r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+jn(this[r],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Nn(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,r){if(void 0===r)return this.lerp(this,e,t);for(let n=0;n<this.ELEMENTS;++n){const s=e[n],o="number"==typeof t?t:t[n];this[n]=s+r*(o-s)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}add(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]+=t[e];return this.check()}subtract(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]-=t[e];return this.check()}scale(e){if("number"==typeof e)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(Sn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}get elements(){return this}}function kn(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Qn(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}class Xn extends Kn{get x(){return this[0]}set x(e){this[0]=kn(e)}get y(){return this[1]}set y(e){this[1]=kn(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let r=0;r<this.ELEMENTS;++r){const n=this[r]-e[r];t+=n*n}return kn(t)}dot(e){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return kn(t)}normalize(){const e=this.magnitude();if(0!==e)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t[e];return this.check()}divide(...e){for(const t of e)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t[e];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Qn(e>=0&&e<this.ELEMENTS,"index is out of range"),kn(this[e])}setComponent(e,t){return Qn(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}let Yn="undefined"!=typeof Float32Array?Float32Array:Array;function Wn(e,t,r){const n=t[0],s=t[1],o=t[2];return e[0]=n*r[0]+s*r[3]+o*r[6],e[1]=n*r[1]+s*r[4]+o*r[7],e[2]=n*r[2]+s*r[5]+o*r[8],e}Math.random,Math.PI,function(){const e=new Yn(3);Yn!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0)}();const Vn=[0,0,0];let Zn;class qn extends Xn{static get ZERO(){return Zn||(Zn=new qn(0,0,0),Object.freeze(Zn)),Zn}constructor(e=0,t=0,r=0){super(-0,-0,-0),1===arguments.length&&Pn(e)?this.copy(e):(Sn.debug&&(kn(e),kn(t),kn(r)),this[0]=e,this[1]=t,this[2]=r)}set(e,t,r){return this[0]=e,this[1]=t,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Sn.debug&&(kn(e.x),kn(e.y),kn(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=kn(e)}angle(e){return function(e,t){const r=e[0],n=e[1],s=e[2],o=t[0],i=t[1],a=t[2],c=Math.sqrt((r*r+n*n+s*s)*(o*o+i*i+a*a)),u=c&&function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}(e,t)/c;return Math.acos(Math.min(Math.max(u,-1),1))}(this,e)}cross(e){return function(e,t,r){const n=t[0],s=t[1],o=t[2],i=r[0],a=r[1],c=r[2];e[0]=s*c-o*a,e[1]=o*i-n*c,e[2]=n*a-s*i}(this,this,e),this.check()}rotateX({radians:e,origin:t=Vn}){return function(e,t,r,n){const s=[],o=[];s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],o[0]=s[0],o[1]=s[1]*Math.cos(n)-s[2]*Math.sin(n),o[2]=s[1]*Math.sin(n)+s[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2]}(this,this,t,e),this.check()}rotateY({radians:e,origin:t=Vn}){return function(e,t,r,n){const s=[],o=[];s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],o[0]=s[2]*Math.sin(n)+s[0]*Math.cos(n),o[1]=s[1],o[2]=s[2]*Math.cos(n)-s[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2]}(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=Vn}){return function(e,t,r,n){const s=[],o=[];s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],o[0]=s[0]*Math.cos(n)-s[1]*Math.sin(n),o[1]=s[0]*Math.sin(n)+s[1]*Math.cos(n),o[2]=s[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2]}(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return function(e,t,r){const n=t[0],s=t[1],o=t[2];let i=r[3]*n+r[7]*s+r[11]*o+r[15];i=i||1,e[0]=(r[0]*n+r[4]*s+r[8]*o+r[12])/i,e[1]=(r[1]*n+r[5]*s+r[9]*o+r[13])/i,e[2]=(r[2]*n+r[6]*s+r[10]*o+r[14])/i}(this,this,e),this.check()}transformAsVector(e){return function(e,t,r){const n=t[0],s=t[1],o=t[2],i=r[3]*n+r[7]*s+r[11]*o||1;e[0]=(r[0]*n+r[4]*s+r[8]*o)/i,e[1]=(r[1]*n+r[5]*s+r[9]*o)/i,e[2]=(r[2]*n+r[6]*s+r[10]*o)/i}(this,this,e),this.check()}transformByMatrix3(e){return Wn(this,this,e),this.check()}transformByMatrix2(e){return function(e,t,r){const n=t[0],s=t[1];e[0]=r[0]*n+r[2]*s,e[1]=r[1]*n+r[3]*s,e[2]=t[2]}(this,this,e),this.check()}transformByQuaternion(e){return function(e,t,r){const n=r[0],s=r[1],o=r[2],i=r[3],a=t[0],c=t[1],u=t[2];let f=s*u-o*c,A=o*a-n*u,l=n*c-s*a,h=s*l-o*A,d=o*f-n*l,B=n*A-s*f;const m=2*i;f*=m,A*=m,l*=m,h*=2,d*=2,B*=2,e[0]=a+f+h,e[1]=c+A+d,e[2]=u+l+B}(this,this,e),this.check()}}class $n extends Kn{toString(){let e="[";if(Sn.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,r){return this[t*this.RANK+e]=kn(r),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let e=0;e<this.RANK;++e)t[e]=this[r+e];return t}setColumn(e,t){const r=e*this.RANK;for(let e=0;e<this.RANK;++e)this[r+e]=t[e];return this}}function zn(e,t,r){const n=t[0],s=t[1],o=t[2],i=t[3],a=t[4],c=t[5],u=t[6],f=t[7],A=t[8],l=r[0],h=r[1],d=r[2],B=r[3],m=r[4],g=r[5],C=r[6],b=r[7],y=r[8];return e[0]=l*n+h*i+d*u,e[1]=l*s+h*a+d*f,e[2]=l*o+h*c+d*A,e[3]=B*n+m*i+g*u,e[4]=B*s+m*a+g*f,e[5]=B*o+m*c+g*A,e[6]=C*n+b*i+y*u,e[7]=C*s+b*a+y*f,e[8]=C*o+b*c+y*A,e}function es(e,t,r){const n=r[0],s=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}var ts;!function(){const e=new Yn(2);Yn!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"}(ts||(ts={}));const rs=Object.freeze([1,0,0,0,1,0,0,0,1]);class ns extends $n{static get IDENTITY(){return os||(os=new ns,Object.freeze(os)),os}static get ZERO(){return ss||(ss=new ns([0,0,0,0,0,0,0,0,0]),Object.freeze(ss)),ss}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return ts}constructor(e,...t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(e)?this.copy(e):t.length>0?this.copy([e,...t]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(rs)}fromObject(e){return this.check()}fromQuaternion(e){return function(e,t){const r=t[0],n=t[1],s=t[2],o=t[3],i=r+r,a=n+n,c=s+s,u=r*i,f=n*i,A=n*a,l=s*i,h=s*a,d=s*c,B=o*i,m=o*a,g=o*c;e[0]=1-A-d,e[3]=f-g,e[6]=l+m,e[1]=f+g,e[4]=1-u-d,e[7]=h-B,e[2]=l-m,e[5]=h+B,e[8]=1-u-A}(this,e),this.check()}set(e,t,r,n,s,o,i,a,c){return this[0]=e,this[1]=t,this[2]=r,this[3]=n,this[4]=s,this[5]=o,this[6]=i,this[7]=a,this[8]=c,this.check()}setRowMajor(e,t,r,n,s,o,i,a,c){return this[0]=e,this[1]=n,this[2]=i,this[3]=t,this[4]=s,this[5]=a,this[6]=r,this[7]=o,this[8]=c,this.check()}determinant(){return function(e){const t=e[0],r=e[1],n=e[2],s=e[3],o=e[4],i=e[5],a=e[6],c=e[7],u=e[8];return t*(u*o-i*c)+r*(-u*s+i*a)+n*(c*s-o*a)}(this)}transpose(){return function(e,t){if(e===t){const r=t[1],n=t[2],s=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=s}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8]}(this,this),this.check()}invert(){return function(e,t){const r=t[0],n=t[1],s=t[2],o=t[3],i=t[4],a=t[5],c=t[6],u=t[7],f=t[8],A=f*i-a*u,l=-f*o+a*c,h=u*o-i*c;let d=r*A+n*l+s*h;d&&(d=1/d,e[0]=A*d,e[1]=(-f*n+s*u)*d,e[2]=(a*n-s*i)*d,e[3]=l*d,e[4]=(f*r-s*c)*d,e[5]=(-a*r+s*o)*d,e[6]=h*d,e[7]=(-u*r+n*c)*d,e[8]=(i*r-n*o)*d)}(this,this),this.check()}multiplyLeft(e){return zn(this,e,this),this.check()}multiplyRight(e){return zn(this,this,e),this.check()}rotate(e){return function(e,t,r){const n=t[0],s=t[1],o=t[2],i=t[3],a=t[4],c=t[5],u=t[6],f=t[7],A=t[8],l=Math.sin(r),h=Math.cos(r);e[0]=h*n+l*i,e[1]=h*s+l*a,e[2]=h*o+l*c,e[3]=h*i-l*n,e[4]=h*a-l*s,e[5]=h*c-l*o,e[6]=u,e[7]=f,e[8]=A}(this,this,e),this.check()}scale(e){return Array.isArray(e)?es(this,this,e):es(this,this,[e,e]),this.check()}translate(e){return function(e,t,r){const n=t[0],s=t[1],o=t[2],i=t[3],a=t[4],c=t[5],u=t[6],f=t[7],A=t[8],l=r[0],h=r[1];e[0]=n,e[1]=s,e[2]=o,e[3]=i,e[4]=a,e[5]=c,e[6]=l*n+h*i+u,e[7]=l*s+h*a+f,e[8]=l*o+h*c+A}(this,this,e),this.check()}transform(e,t){let r;switch(e.length){case 2:r=function(e,t,r){const n=t[0],s=t[1];return e[0]=r[0]*n+r[3]*s+r[6],e[1]=r[1]*n+r[4]*s+r[7],e}(t||[-0,-0],e,this);break;case 3:r=Wn(t||[-0,-0,-0],e,this);break;case 4:r=function(e,t,r){const n=t[0],s=t[1],o=t[2];return e[0]=r[0]*n+r[3]*s+r[6]*o,e[1]=r[1]*n+r[4]*s+r[7]*o,e[2]=r[2]*n+r[5]*s+r[8]*o,e[3]=t[3],e}(t||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return function(e,t,r=""){if(Sn.debug&&!function(e,t){if(e.length!==t)return!1;for(let t=0;t<e.length;++t)if(!Number.isFinite(e[t]))return!1;return!0}(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`)}(r,e.length),r}transformVector(e,t){return this.transform(e,t)}transformVector2(e,t){return this.transform(e,t)}transformVector3(e,t){return this.transform(e,t)}}let ss,os=null;const is="KHR_texture_transform",as=is,cs=new qn,us=new ns,fs=new ns;async function As(e,t){if(!new Ar(e).hasExtension(is)||!t.gltf?.loadBuffers)return;const r=e.json.materials||[];for(let t=0;t<r.length;t++)ls(t,e)}function ls(e,t){const r=t.json.materials?.[e],n=[r?.pbrMetallicRoughness?.baseColorTexture,r?.emissiveTexture,r?.normalTexture,r?.occlusionTexture,r?.pbrMetallicRoughness?.metallicRoughnessTexture],s=[];for(const r of n)r&&r?.extensions?.[is]&&hs(t,e,r,s)}function hs(e,t,r,n){const s=function(e,t){const r=e.extensions?.[is],{texCoord:n=0}=e,{texCoord:s=n}=r;if(!(-1!==t.findIndex((([e,t])=>e===n&&t===s)))){const o=function(e){const{offset:t=[0,0],rotation:r=0,scale:n=[1,1]}=e,s=(new ns).set(1,0,0,0,1,0,t[0],t[1],1),o=us.set(Math.cos(r),Math.sin(r),0,-Math.sin(r),Math.cos(r),0,0,0,1),i=fs.set(n[0],0,0,0,n[1],0,0,0,1);return s.multiplyRight(o).multiplyRight(i)}(r);return n!==s&&(e.texCoord=s),t.push([n,s]),{originalTexCoord:n,texCoord:s,matrix:o}}return null}(r,n);if(!s)return;const o=e.json.meshes||[];for(const r of o)for(const n of r.primitives){const r=n.material;Number.isFinite(r)&&t===r&&ds(e,n,s)}}function ds(e,t,r){const{originalTexCoord:n,texCoord:s,matrix:o}=r,i=t.attributes[`TEXCOORD_${n}`];if(Number.isFinite(i)){const r=e.json.accessors?.[i];if(r&&r.bufferView){const i=e.json.bufferViews?.[r.bufferView];if(i){const{arrayBuffer:a,byteOffset:c}=e.buffers[i.buffer],u=(c||0)+(r.byteOffset||0)+(i.byteOffset||0),{ArrayType:f,length:A}=fr(r,i),l=tr[r.componentType],h=er[r.type],d=i.byteStride||l*h,B=new Float32Array(A);for(let e=0;e<r.count;e++){const t=new f(a,u+e*d,2);cs.set(t[0],t[1],1),cs.transformByMatrix3(o),B.set([cs[0],cs[1]],e*h)}n===s?function(e,t,r,n){e.componentType=5126,r.push({arrayBuffer:n.buffer,byteOffset:0,byteLength:n.buffer.byteLength}),t.buffer=r.length-1,t.byteLength=n.buffer.byteLength,t.byteOffset=0,delete t.byteStride}(r,i,e.buffers,B):function(e,t,r,n,s){n.buffers.push({arrayBuffer:s.buffer,byteOffset:0,byteLength:s.buffer.byteLength});const o=n.json.bufferViews;if(!o)return;o.push({buffer:n.buffers.length-1,byteLength:s.buffer.byteLength,byteOffset:0});const i=n.json.accessors;i&&(i.push({bufferView:o?.length-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),r.attributes[`TEXCOORD_${e}`]=i.length-1)}(s,r,t,e,B)}}}}const Bs="KHR_lights_punctual",ms=Bs;async function gs(e){const t=new Ar(e),{json:r}=t,n=t.getExtension(Bs);n&&(t.json.lights=n.lights,t.removeExtension(Bs));for(const e of r.nodes||[]){const r=t.getObjectExtension(e,Bs);r&&(e.light=r.light),t.removeObjectExtension(e,Bs)}}async function Cs(e){const t=new Ar(e),{json:r}=t;if(r.lights){const e=t.addExtension(Bs);Xt(!e.lights),e.lights=r.lights,delete r.lights}if(t.json.lights){for(const e of t.json.lights){const r=e.node;t.addObjectExtension(r,Bs,e)}delete t.json.lights}}const bs="KHR_materials_unlit",ys=bs;async function ps(e){const t=new Ar(e),{json:r}=t;for(const e of r.materials||[])e.extensions&&e.extensions.KHR_materials_unlit&&(e.unlit=!0),t.removeObjectExtension(e,bs);t.removeExtension(bs)}function Es(e){const t=new Ar(e),{json:r}=t;if(t.materials)for(const e of r.materials||[])e.unlit&&(delete e.unlit,t.addObjectExtension(e,bs,{}),t.addExtension(bs))}const Fs="KHR_techniques_webgl",Is=Fs;async function Gs(e){const t=new Ar(e),{json:r}=t,n=t.getExtension(Fs);if(n){const e=function(e,t){const{programs:r=[],shaders:n=[],techniques:s=[]}=e,o=new TextDecoder;return n.forEach((e=>{if(!Number.isFinite(e.bufferView))throw new Error("KHR_techniques_webgl: no shader code");e.code=o.decode(t.getTypedArrayForBufferView(e.bufferView))})),r.forEach((e=>{e.fragmentShader=n[e.fragmentShader],e.vertexShader=n[e.vertexShader]})),s.forEach((e=>{e.program=r[e.program]})),s}(n,t);for(const n of r.materials||[]){const r=t.getObjectExtension(n,Fs);r&&(n.technique=Object.assign({},r,e[r.technique]),n.technique.values=ws(n.technique,t)),t.removeObjectExtension(n,Fs)}t.removeExtension(Fs)}}async function Ms(e,t){}function ws(e,t){const r=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach((t=>{e.uniforms[t].value&&!(t in r)&&(r[t]=e.uniforms[t].value)})),Object.keys(r).forEach((e=>{"object"==typeof r[e]&&void 0!==r[e].index&&(r[e].texture=t.getTexture(r[e].index))})),r}const vs="EXT_feature_metadata",Ds=vs;async function Ts(e,t){!function(e,t){if(!t.gltf?.loadBuffers)return;const r=e.getExtension(vs);r&&(t.gltf?.loadImages&&function(e,t){const r=t.schema;if(!r)return;const n=r.classes,{featureTextures:s}=t;if(n&&s)for(const t in n){const r=n[t],o=_s(s,t);o&&Os(e,o,r)}}(e,r),function(e,t){const r=t.schema;if(!r)return;const n=r.classes,s=t.featureTables;if(n&&s)for(const t in n){const n=Rs(s,t);n&&Js(e,r,n)}}(e,r))}(new Ar(e),t)}function Rs(e,t){for(const r in e){const n=e[r];if(n.class===t)return n}return null}function _s(e,t){for(const r in e){const n=e[r];if(n.class===t)return n}return null}function Js(e,t,r){if(!r.class)return;const n=t.classes?.[r.class];if(!n)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${r.class}`);const s=r.count;for(const t in n.properties){const o=n.properties[t],i=r.properties?.[t];if(i){const t=Us(e,0,o,s,i);i.data=t}}}function Os(e,t,r){const n=t.class;for(const s in r.properties){const r=t?.properties?.[s];if(r){const t=xs(e,r,n);r.data=t}}}function Us(e,t,r,n,s){let o=[];const i=s.bufferView,a=e.getTypedArrayForBufferView(i),c=function(e,t,r,n){return"ARRAY"===t.type&&void 0===t.componentCount&&void 0!==r.arrayOffsetBufferView?gr(e,r.arrayOffsetBufferView,r.offsetType||"UINT32",n):null}(e,r,s,n),u=function(e,t,r,n){return void 0!==r.stringOffsetBufferView?gr(e,r.stringOffsetBufferView,r.offsetType||"UINT32",n):null}(e,0,s,n);return"STRING"===r.type||"STRING"===r.componentType?o=Ir(n,a,c,u):function(e){const t=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return t.includes(e.type)||void 0!==e.componentType&&t.includes(e.componentType)}(r)&&(o=function(e,t,r,n){const s="ARRAY"===e.type,o=e.componentCount,i="SCALAR",a=e.componentType||e.type,c=mr(i,a),u=Cr(r,i,a,r.byteLength/c);return s?n?Er(u,t,n,r.length,c):o?Fr(u,t,o):[]:u}(r,n,a,c)),o}function xs(e,t,r){const n=e.gltf.json;if(!n.meshes)return[];const s=[];for(const o of n.meshes)for(const n of o.primitives)Hs(e,r,t,s,n);return s}function Hs(e,t,r,n,s){const o=br(e,{channels:r.channels,...r.texture},s);o&&yr(e,t,o,n,s)}const Ls=[s,n,o,i,a,c,f,A,l,u,h];function Ss(e,t){const r=t?.gltf?.excludeExtensions||{};return!(e in r&&!r[e])}const js="KHR_binary_glTF",Ps={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},Ns={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class Ks{idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}};json;normalize(e,t){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:return void console.warn(`glTF: Unknown version ${r.asset.version}`)}if(!t.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),function(e){const t=new Ar(e),{json:r}=t;for(const e of r.images||[]){const r=t.getObjectExtension(e,js);r&&Object.assign(e,r),t.removeObjectExtension(e,js)}r.buffers&&r.buffers[0]&&delete r.buffers[0].uri,t.removeExtension(js)}(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const t in Ps)this._convertTopLevelObjectToArray(e,t)}_convertTopLevelObjectToArray(e,t){const r=e[t];if(r&&!Array.isArray(r)){e[t]=[];for(const n in r){const s=r[n];s.id=s.id||n;const o=e[t].length;e[t].push(s),this.idToIndexMap[t][n]=o}}}_convertObjectIdsToArrayIndices(e){for(const t in Ps)this._convertIdsToIndices(e,t);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const t of e.textures)this._convertTextureIds(t);for(const t of e.meshes)this._convertMeshIds(t);for(const t of e.nodes)this._convertNodeIds(t);for(const t of e.scenes)this._convertSceneIds(t)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const t of e.primitives){const{attributes:e,indices:r,material:n}=t;for(const t in e)e[t]=this._convertIdToIndex(e[t],"accessor");r&&(t.indices=this._convertIdToIndex(r,"accessor")),n&&(t.material=this._convertIdToIndex(n,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map((e=>this._convertIdToIndex(e,"node")))),e.meshes&&(e.meshes=e.meshes.map((e=>this._convertIdToIndex(e,"mesh"))))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map((e=>this._convertIdToIndex(e,"node"))))}_convertIdsToIndices(e,t){e[t]||(console.warn(`gltf v1: json doesn't contain attribute ${t}`),e[t]=[]);for(const r of e[t])for(const e in r){const t=r[e],n=this._convertIdToIndex(t,e);r[e]=n}}_convertIdToIndex(e,t){const r=Ns[t];if(r in this.idToIndexMap){const n=this.idToIndexMap[r][e];if(!Number.isFinite(n))throw new Error(`gltf v1: failed to resolve ${t} with id ${e}`);return n}return e}_updateObjects(e){for(const e of this.json.buffers)delete e.type}_updateMaterial(e){for(const t of e.materials){t.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const r=t.values?.tex||t.values?.texture2d_0||t.values?.diffuseTex,n=e.textures.findIndex((e=>e.id===r));-1!==n&&(t.pbrMetallicRoughness.baseColorTexture={index:n})}}}async function ks(e,t,r=0,n,s){return function(e,t,r,n){if(n.uri&&(e.baseUri=n.uri),t instanceof ArrayBuffer&&!function(e,t=0,r={}){const n=new DataView(e),{magic:s=Zt}=r,o=n.getUint32(t,!1);return o===s||o===Zt}(t,r,n)&&(t=(new TextDecoder).decode(t)),"string"==typeof t)e.json=function(e){try{return JSON.parse(e)}catch(t){throw new Error(`Failed to parse JSON from data starting with "${function(e,t=5){return"string"==typeof e?e.slice(0,t):ArrayBuffer.isView(e)?at(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?at(e,0,t):""}(e)}"`)}}(t);else if(t instanceof ArrayBuffer){const s={};r=function(e,t,r=0){const n=new DataView(t),s=function(e,t=0){return`${String.fromCharCode(e.getUint8(t+0))}${String.fromCharCode(e.getUint8(t+1))}${String.fromCharCode(e.getUint8(t+2))}${String.fromCharCode(e.getUint8(t+3))}`}(n,r+0),o=n.getUint32(r+4,Vt),i=n.getUint32(r+8,Vt);switch(Object.assign(e,{header:{byteOffset:r,byteLength:i,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),r+=12,e.version){case 1:return function(e,t,r){v(e.header.byteLength>20);const n=t.getUint32(r+0,Vt),s=t.getUint32(r+4,Vt);return r+=8,v(0===s),qt(e,t,r,n),(r+=n)+$t(e,t,r,e.header.byteLength)}(e,n,r);case 2:return function(e,t,r){return v(e.header.byteLength>20),function(e,t,r,n){for(;r+8<=e.header.byteLength;){const s=t.getUint32(r+0,Vt),o=t.getUint32(r+4,Vt);switch(r+=8,o){case 1313821514:qt(e,t,r,s);break;case 5130562:$t(e,t,r,s);break;case 0:n.strict||qt(e,t,r,s);break;case 1:n.strict||$t(e,t,r,s)}r+=Yt(s,4)}}(e,t,r,{}),r+e.header.byteLength}(e,n,r);default:throw new Error(`Invalid GLB version ${e.version}. Only supports version 1 and 2.`)}}(s,t,r,n.glb),Xt("glTF"===s.type,`Invalid GLB magic string ${s.type}`),e._glb=s,e.json=s.json}else Xt(!1,"GLTF: must be ArrayBuffer or string");const s=e.json.buffers||[];if(e.buffers=new Array(s.length).fill(null),e._glb&&e._glb.header.hasBinChunk){const{binChunks:t}=e._glb;e.buffers[0]={arrayBuffer:t[0].arrayBuffer,byteOffset:t[0].byteOffset,byteLength:t[0].byteLength}}const o=e.json.images||[];e.images=new Array(o.length).fill({})}(e,t,r,n),function(e,t={}){(new Ks).normalize(e,t)}(e,{normalize:n?.gltf?.normalize}),function(e,t={},r){const n=Ls.filter((e=>Ss(e.name,t)));for(const s of n)s.preprocess?.(e,t,r)}(e,n,s),n?.gltf?.loadBuffers&&e.json.buffers&&await async function(e,t,r){const n=e.json.buffers||[];for(let s=0;s<n.length;++s){const o=n[s];if(o.uri){const{fetch:n}=r;Xt(n);const i=zt(o.uri,t),a=await(r?.fetch?.(i)),c=await(a?.arrayBuffer?.());e.buffers[s]={arrayBuffer:c,byteOffset:0,byteLength:c.byteLength},delete o.uri}else null===e.buffers[s]&&(e.buffers[s]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}(e,n,s),n?.gltf?.loadImages&&await async function(e,t,r){const n=function(e){const t=new Set,r=e.json.textures||[];for(const e of r)void 0!==e.source&&t.add(e.source);return Array.from(t).sort()}(e),s=e.json.images||[],o=[];for(const i of n)o.push(Qs(e,s[i],i,t,r));return await Promise.all(o)}(e,n,s),await async function(e,t={},r){const n=Ls.filter((e=>Ss(e.name,t)));for(const s of n)await(s.decode?.(e,t,r))}(e,n,s),e}async function Qs(e,t,r,n,s){let o;if(t.uri&&!t.hasOwnProperty("bufferView")){const e=zt(t.uri,n),{fetch:r}=s,i=await r(e);o=await i.arrayBuffer(),t.bufferView={data:o}}if(Number.isFinite(t.bufferView)){const r=function(e,t,r){const n=e.bufferViews[r];Xt(n);const s=t[n.buffer];Xt(s);const o=(n.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,o,n.byteLength)}(e.json,e.buffers,t.bufferView);o=Pe(r.buffer,r.byteOffset,r.byteLength)}Xt(o,"glTF image has no data");let i=await ct(o,[wt,Qt],{...n,mimeType:t.mimeType,basis:n.basis||{format:kt()}},s);i&&i[0]&&(i={compressed:!0,mipmaps:!1,width:i[0].width,height:i[0].height,data:i[0]}),e.images=e.images||[],e.images[r]=i}const Xs={dataType:null,batchType:null,name:"glTF",id:"gltf",module:"gltf",version:"4.3.2",extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:async function(e,t={},r){(t={...Xs.options,...t}).gltf={...Xs.options.gltf,...t.gltf};const{byteOffset:n=0}=t;return await ks({},e,n,t,r)},options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}},Ys={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ws={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Vs=10240,Zs=10241,qs=10242,$s=10243,zs={magFilter:10240,minFilter:10241,wrapS:10242,wrapT:10243},eo={[Vs]:9729,[Zs]:9986,[qs]:10497,[$s]:10497};class to{baseUri="";jsonUnprocessed;json;buffers=[];images=[];postProcess(e,t={}){const{json:r,buffers:n=[],images:s=[]}=e,{baseUri:o=""}=e;return Xt(r),this.baseUri=o,this.buffers=n,this.images=s,this.jsonUnprocessed=r,this.json=this._resolveTree(e.json,t),this.json}_resolveTree(e,t={}){const r={...e};return this.json=r,e.bufferViews&&(r.bufferViews=e.bufferViews.map(((e,t)=>this._resolveBufferView(e,t)))),e.images&&(r.images=e.images.map(((e,t)=>this._resolveImage(e,t)))),e.samplers&&(r.samplers=e.samplers.map(((e,t)=>this._resolveSampler(e,t)))),e.textures&&(r.textures=e.textures.map(((e,t)=>this._resolveTexture(e,t)))),e.accessors&&(r.accessors=e.accessors.map(((e,t)=>this._resolveAccessor(e,t)))),e.materials&&(r.materials=e.materials.map(((e,t)=>this._resolveMaterial(e,t)))),e.meshes&&(r.meshes=e.meshes.map(((e,t)=>this._resolveMesh(e,t)))),e.nodes&&(r.nodes=e.nodes.map(((e,t)=>this._resolveNode(e,t))),r.nodes=r.nodes.map(((e,t)=>this._resolveNodeChildren(e)))),e.skins&&(r.skins=e.skins.map(((e,t)=>this._resolveSkin(e,t)))),e.scenes&&(r.scenes=e.scenes.map(((e,t)=>this._resolveScene(e,t)))),"number"==typeof this.json.scene&&r.scenes&&(r.scene=r.scenes[this.json.scene]),r}getScene(e){return this._get(this.json.scenes,e)}getNode(e){return this._get(this.json.nodes,e)}getSkin(e){return this._get(this.json.skins,e)}getMesh(e){return this._get(this.json.meshes,e)}getMaterial(e){return this._get(this.json.materials,e)}getAccessor(e){return this._get(this.json.accessors,e)}getCamera(e){return this._get(this.json.cameras,e)}getTexture(e){return this._get(this.json.textures,e)}getSampler(e){return this._get(this.json.samplers,e)}getImage(e){return this._get(this.json.images,e)}getBufferView(e){return this._get(this.json.bufferViews,e)}getBuffer(e){return this._get(this.json.buffers,e)}_get(e,t){if("object"==typeof t)return t;const r=e&&e[t];return r||console.warn(`glTF file error: Could not find ${e}[${t}]`),r}_resolveScene(e,t){return{...e,id:e.id||`scene-${t}`,nodes:(e.nodes||[]).map((e=>this.getNode(e)))}}_resolveNode(e,t){const r={...e,id:e?.id||`node-${t}`};return void 0!==e.mesh&&(r.mesh=this.getMesh(e.mesh)),void 0!==e.camera&&(r.camera=this.getCamera(e.camera)),void 0!==e.skin&&(r.skin=this.getSkin(e.skin)),void 0!==e.meshes&&e.meshes.length&&(r.mesh=e.meshes.reduce(((e,t)=>{const r=this.getMesh(t);return e.id=r.id,e.primitives=e.primitives.concat(r.primitives),e}),{primitives:[]})),r}_resolveNodeChildren(e){return e.children&&(e.children=e.children.map((e=>this.getNode(e)))),e}_resolveSkin(e,t){const r="number"==typeof e.inverseBindMatrices?this.getAccessor(e.inverseBindMatrices):void 0;return{...e,id:e.id||`skin-${t}`,inverseBindMatrices:r}}_resolveMesh(e,t){const r={...e,id:e.id||`mesh-${t}`,primitives:[]};return e.primitives&&(r.primitives=e.primitives.map((e=>{const t={...e,attributes:{},indices:void 0,material:void 0},r=e.attributes;for(const e in r)t.attributes[e]=this.getAccessor(r[e]);return void 0!==e.indices&&(t.indices=this.getAccessor(e.indices)),void 0!==e.material&&(t.material=this.getMaterial(e.material)),t}))),r}_resolveMaterial(e,t){const r={...e,id:e.id||`material-${t}`};if(r.normalTexture&&(r.normalTexture={...r.normalTexture},r.normalTexture.texture=this.getTexture(r.normalTexture.index)),r.occlusionTexture&&(r.occlusionTexture={...r.occlusionTexture},r.occlusionTexture.texture=this.getTexture(r.occlusionTexture.index)),r.emissiveTexture&&(r.emissiveTexture={...r.emissiveTexture},r.emissiveTexture.texture=this.getTexture(r.emissiveTexture.index)),r.emissiveFactor||(r.emissiveFactor=r.emissiveTexture?[1,1,1]:[0,0,0]),r.pbrMetallicRoughness){r.pbrMetallicRoughness={...r.pbrMetallicRoughness};const e=r.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return r}_resolveAccessor(e,t){const r=(n=e.componentType,Ws[n]);var n;const s=(o=e.type,Ys[o]);var o;const i=r*s,a={...e,id:e.id||`accessor-${t}`,bytesPerComponent:r,components:s,bytesPerElement:i,value:void 0,bufferView:void 0,sparse:void 0};if(void 0!==e.bufferView&&(a.bufferView=this.getBufferView(e.bufferView)),a.bufferView){const e=a.bufferView.buffer,{ArrayType:t,byteLength:r}=fr(a,a.bufferView),n=(a.bufferView.byteOffset||0)+(a.byteOffset||0)+e.byteOffset;let s=e.arrayBuffer.slice(n,n+r);a.bufferView.byteStride&&(s=this._getValueFromInterleavedBuffer(e,n,a.bufferView.byteStride,a.bytesPerElement,a.count)),a.value=new t(s)}return a}_getValueFromInterleavedBuffer(e,t,r,n,s){const o=new Uint8Array(s*n);for(let i=0;i<s;i++){const s=t+i*r;o.set(new Uint8Array(e.arrayBuffer.slice(s,s+n)),i*n)}return o.buffer}_resolveTexture(e,t){return{...e,id:e.id||`texture-${t}`,sampler:"number"==typeof e.sampler?this.getSampler(e.sampler):{id:"default-sampler",parameters:eo},source:"number"==typeof e.source?this.getImage(e.source):void 0}}_resolveSampler(e,t){const r={id:e.id||`sampler-${t}`,...e,parameters:{}};for(const e in r){const t=this._enumSamplerParameter(e);void 0!==t&&(r.parameters[t]=r[e])}return r}_enumSamplerParameter(e){return zs[e]}_resolveImage(e,t){const r={...e,id:e.id||`image-${t}`,image:null,bufferView:void 0!==e.bufferView?this.getBufferView(e.bufferView):void 0},n=this.images[t];return n&&(r.image=n),r}_resolveBufferView(e,t){const r=e.buffer,n=this.buffers[r].arrayBuffer;let s=this.buffers[r].byteOffset||0;return e.byteOffset&&(s+=e.byteOffset),{id:`bufferView-${t}`,...e,buffer:this.buffers[r],data:new Uint8Array(n,s,e.byteLength)}}_resolveCamera(e,t){const r={...e,id:e.id||`camera-${t}`};return r.perspective,r.orthographic,r}}class ro{constructor(){this.v=[],this.vt=[],this.vn=[],this.triangles=[]}async initialize(e,t){this.color=e,await this.readFile(t)}async readFile(e){const t=await async function(e,t){let r,n;Array.isArray(t)||D(t)?(r=t,n=void 0):(r=[],n=t);const s=be(n);let o=e;return"string"==typeof e&&(o=await s(e)),M(e)&&(o=await s(e)),Array.isArray(r),await it(o,r,n)}(e,Xs),r=(n=t,(new to).postProcess(n,undefined));var n;const s=r.meshes[0].primitives[0].attributes.POSITION.count,o=new Float32Array(r.meshes[0].primitives[0].attributes.POSITION.value),i=(new Float32Array(r.meshes[0].primitives[0].attributes.NORMAL.value),new Float32Array(r.meshes[0].primitives[0].attributes.TEXCOORD_0.value));for(var a=0;a<s;a++){var c=new p;c.corners.push([o[3*a],o[3*a+1],o[3*a+2]]),c.corners.push([o[3*(a+1)],o[3*(a+1)+1],o[3*(a+1)+2]]),c.corners.push([o[3*(a+2)],o[3*(a+2)+1],o[3*(a+2)+2]]),null!=i&&(c.uv.push([i[2*a],i[2*a+1]]),c.uv.push([i[2*(a+1)],i[2*(a+1)+1]]),c.uv.push([i[2*(a+2)],i[2*(a+2)+1]])),c.color=this.color,c.make_centroid(),this.triangles.push(c)}}read_corner_vertex(e,t){const r=e.split("/");return this.v[Number(r[0]).valueOf()-1]}read_corner_tex_coord(e,t){const r=e.split("/");return this.vt[Number(r[1]).valueOf()-1]}read_corner_normal(e,t){const r=e.split("/");return this.vn[Number(r[2]).valueOf()-1]}}class no{constructor(e){this.nodesUsed=0,this.mesh=new ro,this.camera=new b([-5,0,0])}async make_scene(){await this.mesh.initialize([1,1,1],"dist/models/man_head_2.glb"),this.triangles=[],this.mesh.triangles.forEach((e=>{this.triangles.push(e)})),this.triangleCount=this.triangles.length,await this.buildBVH()}async buildBVH(){this.triangleIndices=new Array(this.triangles.length);for(var e=0;e<this.triangles.length;e++)this.triangleIndices[e]=e;for(this.nodes=new Array(2*this.triangles.length-1),e=0;e<2*this.triangles.length-1;e++)this.nodes[e]=new y;var t=this.nodes[0];t.leftChild=0,t.primitiveCount=this.triangles.length,this.nodesUsed+=1,this.updateBounds(0),this.subdivide(0)}updateBounds(e){var t=this.nodes[e];t.minCorner=[99999,99999,99999],t.maxCorner=[-99999,-99999,-99999];for(var r=0;r<t.primitiveCount;r++)this.triangles[this.triangleIndices[t.leftChild+r]].corners.forEach((e=>{m(t.minCorner,t.minCorner,e),g(t.maxCorner,t.maxCorner,e)}))}subdivide(e){var t=this.nodes[e];if(t.primitiveCount<=4)return;var r=[0,0,0];!function(e,t,r){e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2]}(r,t.maxCorner,t.minCorner);var n=0;r[1]>r[n]&&(n=1),r[2]>r[n]&&(n=2);const s=t.minCorner[n]+r[n]/2;for(var o=t.leftChild,i=o+t.primitiveCount-1;o<=i;)if(this.triangles[this.triangleIndices[o]].centroid[n]<s)o+=1;else{var a=this.triangleIndices[o];this.triangleIndices[o]=this.triangleIndices[i],this.triangleIndices[i]=a,i-=1}var c=o-t.leftChild;if(0==c||c==t.primitiveCount)return;const u=this.nodesUsed;this.nodesUsed+=1;const f=this.nodesUsed;this.nodesUsed+=1,this.nodes[u].leftChild=t.leftChild,this.nodes[u].primitiveCount=c,this.nodes[f].leftChild=o,this.nodes[f].primitiveCount=t.primitiveCount-c,t.leftChild=u,t.primitiveCount=0,this.updateBounds(u),this.updateBounds(f),this.subdivide(u),this.subdivide(f)}}}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return s[e](r,r.exports,i),r.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",r="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},i.a=(s,o,i)=>{var a;i&&((a=[]).d=-1);var c,u,f,A=new Set,l=s.exports,h=new Promise(((e,t)=>{f=t,u=e}));h[t]=l,h[e]=e=>(a&&e(a),A.forEach(e),h.catch((e=>{}))),s.exports=h,o((s=>{var o;c=(s=>s.map((s=>{if(null!==s&&"object"==typeof s){if(s[e])return s;if(s.then){var o=[];o.d=0,s.then((e=>{i[t]=e,n(o)}),(e=>{i[r]=e,n(o)}));var i={};return i[e]=e=>e(o),i}}var a={};return a[e]=e=>{},a[t]=s,a})))(s);var i=()=>c.map((e=>{if(e[r])throw e[r];return e[t]})),u=new Promise((t=>{(o=()=>t(i)).r=0;var r=e=>e!==a&&!A.has(e)&&(A.add(e),e&&!e.d&&(o.r++,e.push(o)));c.map((t=>t[e](r)))}));return o.r?u:i()}),(e=>(e?f(h[r]=e):u(l),n(a)))),a&&a.d<0&&(a.d=0)},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(927)})();